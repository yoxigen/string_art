{"mappings":"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","sources":["src/scripts/helpers/Color.js","src/scripts/Nails.js","src/scripts/StringArt.js","src/scripts/helpers/Circle.js","src/scripts/string_art_types/Spiral.js","src/scripts/string_art_types/Spirals.js","src/scripts/string_art_types/Eye.js","src/scripts/helpers/Polygon.js","src/scripts/string_art_types/PolygonPattern.js","src/scripts/string_art_types/Flower.js","src/scripts/pattern_types.js","src/scripts/string_art_types/Star.js","src/scripts/string_art_types/Assymetry.js","src/scripts/string_art_types/TimesTables.js","src/scripts/string_art_types/Wave.js","src/scripts/string_art_types/Circles.js","src/scripts/editor/EditorControls.js","src/scripts/editor/EditorSizeControls.js","src/scripts/main.js","src/scripts/editor/Player.js","src/scripts/thumbnails/Thumbnails.js"],"sourcesContent":["const COLOR_CONTROLS = [\n  {\n    key: 'isMultiColor',\n    label: 'Use multiple colors',\n    defaultValue: false,\n    type: 'checkbox',\n  },\n  {\n    key: 'color',\n    label: 'String color',\n    defaultValue: '#ff4d00',\n    type: 'color',\n    show: ({ isMultiColor }) => !isMultiColor,\n  },\n  {\n    key: 'colorCount',\n    label: 'Colors count',\n    defaultValue: 7,\n    type: 'range',\n    attr: {\n      min: 1,\n      max: 20,\n      step: 1,\n    },\n    show: ({ isMultiColor }) => isMultiColor,\n  },\n  {\n    key: 'multicolorRange',\n    label: 'Multicolor range',\n    defaultValue: 360,\n    type: 'range',\n    attr: {\n      min: 1,\n      max: 360,\n      step: 1,\n    },\n    show: ({ isMultiColor }) => isMultiColor,\n  },\n  {\n    key: 'multicolorStart',\n    label: 'Multicolor start',\n    defaultValue: 0,\n    type: 'range',\n    attr: {\n      min: 0,\n      max: 360,\n      step: 1,\n    },\n    show: ({ isMultiColor }) => isMultiColor,\n  },\n  {\n    key: 'reverseColors',\n    label: 'Reverse colors order',\n    defaultValue: false,\n    type: 'checkbox',\n    show: ({ isMultiColor }) => isMultiColor,\n  },\n  {\n    key: 'saturation',\n    label: 'Saturation',\n    defaultValue: 100,\n    type: 'range',\n    attr: {\n      min: 0,\n      max: 100,\n      step: 1,\n    },\n    show: ({ isMultiColor }) => isMultiColor,\n  },\n  {\n    key: 'lightness',\n    label: 'Lightness',\n    type: 'group',\n    defaultValue: 'minimized',\n    show: ({ isMultiColor }) => isMultiColor,\n    children: [\n      {\n        key: 'multicolorByLightness',\n        label: 'Multi lightness',\n        defaultValue: false,\n        type: 'checkbox',\n        show: ({ isMultiColor }) => isMultiColor,\n      },\n      {\n        key: 'minLightness',\n        label: 'Minimum lightness',\n        defaultValue: 0,\n        type: 'range',\n        attr: {\n          min: 0,\n          max: 100,\n          step: 1,\n        },\n        show: ({ multicolorByLightness, isMultiColor }) =>\n          multicolorByLightness && isMultiColor,\n      },\n      {\n        key: 'maxLightness',\n        label: 'Maximum lightness',\n        defaultValue: 100,\n        type: 'range',\n        attr: {\n          min: 0,\n          max: 100,\n          step: 1,\n        },\n        show: ({ multicolorByLightness, isMultiColor }) =>\n          multicolorByLightness && isMultiColor,\n      },\n    ],\n  },\n];\n\nexport default class Color {\n  constructor(config) {\n    this.config = config;\n    const {\n      multicolorRange,\n      colorCount,\n      multicolorByLightness,\n      minLightness = 0,\n      maxLightness = 100,\n      multicolorStart,\n      darkMode,\n      saturation,\n      reverseColors,\n      isMultiColor,\n    } = config;\n\n    if (isMultiColor) {\n      this.multiColorStep = multicolorRange / colorCount;\n      this.multiColorLightnessStep = multicolorByLightness\n        ? (maxLightness - minLightness) / (colorCount - 1)\n        : 1;\n\n      this.colors = new Array(colorCount).fill(null).map((_, colorIndex) => {\n        const lightness = multicolorByLightness\n          ? minLightness + this.multiColorLightnessStep * colorIndex\n          : darkMode\n          ? 50\n          : 40;\n        return `hsl(${\n          multicolorStart + colorIndex * this.multiColorStep\n        }, ${saturation}%, ${lightness}%)`;\n      });\n\n      if (reverseColors) {\n        this.colors.reverse();\n      }\n    }\n  }\n\n  /**\n   * Returns the color to be used in the provided layer index. If no multiColor is used, will use the 'color' config property.\n   * @param {number} colorIndex\n   * @returns string\n   */\n  getColor(colorIndex) {\n    const { isMultiColor, colorCount, color } = this.config;\n\n    if (!isMultiColor) {\n      return color;\n    }\n\n    if (colorIndex >= colorCount) {\n      colorIndex = colorCount - 1;\n    }\n\n    return this.colors[colorIndex];\n  }\n\n  getColorMap({ stepCount, colorCount }) {\n    if (!colorCount) {\n      throw new Error(\"Can't get color map, no colorCount provided!\");\n    }\n    const stepsPerColor = Math.floor(stepCount / colorCount);\n    const colorMap = new Map();\n    for (let i = 0; i < colorCount; i++) {\n      colorMap.set(i * stepsPerColor, this.getColor(i));\n    }\n    return colorMap;\n  }\n\n  static getConfig({ include, exclude, defaults = {} }) {\n    const controls = getControls();\n\n    return {\n      key: 'colorGroup',\n      label: 'Color',\n      type: 'group',\n      children: controls,\n    };\n\n    function getControls(controlsConfig = COLOR_CONTROLS) {\n      return controlsConfig\n        .filter(\n          ({ key }) =>\n            (!exclude || !exclude.includes(key)) &&\n            (!include || include.includes(key))\n        )\n        .map(control => {\n          const finalControl = {\n            ...control,\n            defaultValue: defaults[control.key] ?? control.defaultValue,\n          };\n\n          if (control.type === 'group') {\n            finalControl.children = getControls(control.children);\n          }\n          return Object.freeze(finalControl);\n        });\n    }\n  }\n}\n","const PI2 = Math.PI * 2;\nconst NUMBER_MARGIN = 4;\n\nexport default class Nails {\n  constructor(canvas, config) {\n    this.context = canvas.getContext('2d');\n    this.setConfig(config);\n    this.centerX = canvas.width / 2;\n    this.nails = [];\n  }\n\n  setConfig({ nailRadius, nailsColor, nailNumbersFontSize }) {\n    this.nailRadius = nailRadius;\n    this.nailsColor = nailsColor;\n    this.nailNumbersFontSize = nailNumbersFontSize;\n    this.nails = [];\n  }\n\n  // Adds a nail to be rendered. nail: { point, number }\n  addNail(nail) {\n    this.nails.push(nail);\n  }\n\n  fill({ drawNumbers = true } = {}) {\n    this.context.globalCompositeOperation = 'source-over';\n    this.context.beginPath();\n    this.context.fillStyle = this.nailsColor;\n    this.context.textBaseline = 'middle';\n    this.context.font = `${this.nailNumbersFontSize}px sans-serif`;\n    const nailNumberOffset = this.nailRadius + NUMBER_MARGIN;\n\n    this.nails.forEach(({ point: [x, y], number }) => {\n      this.context.moveTo(x + this.nailRadius, y);\n      this.context.arc(x, y, this.nailRadius, 0, PI2);\n      if (drawNumbers && number !== undefined && number !== null) {\n        const isRightAlign = x < this.centerX;\n\n        const numberPosition = [\n          isRightAlign ? x - nailNumberOffset : x + nailNumberOffset,\n          y,\n        ];\n\n        this.context.textAlign = isRightAlign ? 'right' : 'left';\n        this.context.fillText(String(number), ...numberPosition);\n      }\n    });\n\n    this.context.fill();\n    this.nails = [];\n  }\n}\n","import Nails from './Nails.js';\n\nconst COLORS = {\n  dark: '#0e0e0e',\n  light: '#ffffff',\n};\n\nconst COMMON_CONFIG_CONTROLS = [\n  {\n    key: 'strings',\n    label: 'Strings',\n    type: 'group',\n    defaultValue: 'minimized',\n    children: [\n      {\n        key: 'showStrings',\n        label: 'Show strings',\n        defaultValue: true,\n        type: 'checkbox',\n        isDisabled: ({ showNails }) => !showNails,\n      },\n      {\n        key: 'stringWidth',\n        label: 'String width',\n        defaultValue: 1,\n        type: 'range',\n        attr: { min: 0.2, max: 4, step: 0.2 },\n        show: ({ showStrings }) => showStrings,\n      },\n    ],\n  },\n  {\n    key: 'nails',\n    label: 'Nails',\n    type: 'group',\n    defaultValue: 'minimized',\n    children: [\n      {\n        key: 'showNails',\n        label: 'Show nails',\n        defaultValue: true,\n        type: 'checkbox',\n        isDisabled: ({ showStrings }) => !showStrings,\n      },\n      {\n        key: 'margin',\n        label: 'Margin',\n        defaultValue: 20,\n        type: 'number',\n        attr: { min: 0, max: 500, step: 1 },\n        displayValue: ({ margin }) => `${margin}px`,\n      },\n      {\n        key: 'nailRadius',\n        label: 'Nail size',\n        defaultValue: 1.5,\n        type: 'range',\n        attr: { min: 0.5, max: 5, step: 0.25 },\n        show: ({ showNails }) => showNails,\n      },\n      {\n        key: 'nailsColor',\n        label: 'Nails color',\n        defaultValue: '#ffffff',\n        type: 'color',\n      },\n      {\n        key: 'showNailNumbers',\n        label: 'Show nail numbers',\n        defaultValue: false,\n        type: 'checkbox',\n        show: ({ showNails }) => showNails,\n      },\n      {\n        key: 'nailNumbersFontSize',\n        label: 'Nail numbers font size',\n        defaultValue: 10,\n        type: 'range',\n        attr: { min: 6, max: 24, step: 0.5 },\n        displayValue: ({ nailNumbersFontSize }) => `${nailNumbersFontSize}px`,\n        show: ({ showNails, showNailNumbers }) => showNails && showNailNumbers,\n      },\n    ],\n  },\n  {\n    key: 'background',\n    label: 'Background',\n    type: 'group',\n    defaultValue: 'minimized',\n    children: [\n      {\n        key: 'darkMode',\n        label: 'Dark mode',\n        defaultValue: true,\n        type: 'checkbox',\n        isDisabled: ({ enableBackground }) => !enableBackground,\n      },\n      {\n        key: 'customBackgroundColor',\n        label: 'Custom background color',\n        defaultValue: false,\n        type: 'checkbox',\n        isDisabled: ({ enableBackground }) => !enableBackground,\n      },\n      {\n        key: 'backgroundColor',\n        label: 'Background color',\n        defaultValue: COLORS.dark,\n        type: 'color',\n        show: ({ customBackgroundColor }) => customBackgroundColor,\n        isDisabled: ({ enableBackground }) => !enableBackground,\n      },\n      {\n        key: 'enableBackground',\n        label: 'Enable background',\n        defaultValue: true,\n        type: 'checkbox',\n      },\n    ],\n  },\n];\n\nclass StringArt {\n  constructor(canvas) {\n    if (!canvas) {\n      throw new Error('Canvas not specified!');\n    }\n\n    this.canvas = canvas;\n    this.ctx = this.canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    const bsr =\n      this.ctx.webkitBackingStorePixelRatio ||\n      this.ctx.mozBackingStorePixelRatio ||\n      this.ctx.msBackingStorePixelRatio ||\n      this.ctx.oBackingStorePixelRatio ||\n      this.ctx.backingStorePixelRatio ||\n      1;\n    this.pixelRatio = dpr / bsr;\n  }\n\n  get configControls() {\n    return (this.controls ?? []).concat(COMMON_CONFIG_CONTROLS);\n  }\n\n  get defaultConfig() {\n    if (!this._defaultConfig) {\n      this._defaultConfig = flattenConfig(this.configControls);\n    }\n\n    return this._defaultConfig;\n  }\n\n  get config() {\n    return this._config ?? this.defaultConfig;\n  }\n\n  set config(value) {\n    this._config = Object.assign({}, this.defaultConfig, value);\n  }\n\n  getSize() {\n    const canvasScreenSize = [\n      this.canvas.clientWidth,\n      this.canvas.clientHeight,\n    ];\n    return canvasScreenSize.map(v => v * this.pixelRatio);\n  }\n\n  setUpDraw() {\n    this.canvas.removeAttribute('width');\n    this.canvas.removeAttribute('height');\n    const [width, height] = (this.size = this.getSize());\n    Object.assign(this, this.size);\n    this.canvas.setAttribute('width', width);\n    this.canvas.setAttribute('height', height);\n    this.center = this.size.map(value => value / 2);\n\n    if (this.nails) {\n      this.nails.setConfig(this.config);\n    } else {\n      this.nails = new Nails(this.canvas, this.config);\n    }\n\n    this.ctx.clearRect(0, 0, ...this.size);\n    this.ctx.lineWidth = this.config.stringWidth;\n  }\n\n  afterDraw() {\n    const { showNails, showNailNumbers } = this.config;\n    if (showNails) {\n      this.drawNails();\n      this.nails.fill({ drawNumbers: showNailNumbers });\n    }\n  }\n\n  initDraw() {\n    this.setUpDraw(this.config);\n    const {\n      showNails,\n      showNailNumbers,\n      darkMode,\n      backgroundColor,\n      customBackgroundColor,\n      enableBackground,\n    } = this.config;\n\n    this.ctx.beginPath();\n    if (enableBackground) {\n      this.ctx.globalCompositeOperation = 'destination-over';\n      this.ctx.fillStyle = customBackgroundColor\n        ? backgroundColor\n        : darkMode\n        ? COLORS.dark\n        : COLORS.light;\n      this.ctx.fillRect(0, 0, ...this.size);\n    }\n\n    this.ctx.globalCompositeOperation = 'source-over';\n    if (showNails) {\n      this.drawNails();\n      this.nails.fill({ drawNumbers: showNailNumbers });\n    }\n  }\n\n  /**\n   * Draws the string art on canvas\n   * @param { step: number } renderConfig configuration for rendering. Accepts the step to render (leave undefined or null to render all)\n   */\n  draw({ position = Infinity } = {}) {\n    this.initDraw();\n    const { showStrings } = this.config;\n\n    if (showStrings) {\n      this.stringsIterator = this.generateStrings();\n      this.position = 0;\n\n      while (!this.drawNext().done && this.position < position);\n      this.afterDraw();\n    }\n  }\n\n  goto(position) {\n    if (position === this.position) {\n      return;\n    }\n\n    if (this.stringsIterator && position > this.position) {\n      while (!this.drawNext().done && this.position < position);\n    } else {\n      this.draw({ position });\n    }\n  }\n\n  drawNext() {\n    const result = this.stringsIterator.next();\n\n    if (result.done) {\n      this.afterDraw();\n    } else {\n      this.position++;\n    }\n\n    return result;\n  }\n\n  generateStrings() {\n    throw new Error('generateStrings method not defined!');\n  }\n\n  getStepCount() {\n    throw new Error(\n      `'getStepCount' method not implemented for string art type \"${this.name}\"`\n    );\n  }\n}\n\nfunction flattenConfig(configControls) {\n  return configControls.reduce(\n    (config, { key, defaultValue, children }) =>\n      children\n        ? {\n            ...config,\n            ...flattenConfig(children),\n          }\n        : {\n            ...config,\n            [key]: defaultValue,\n          },\n    {}\n  );\n}\n\nexport default StringArt;\n","import Nails from '../Nails.js';\n\nconst PI2 = Math.PI * 2;\n\nexport default class Circle {\n  constructor(config) {\n    this.setConfig(config);\n  }\n\n  getPoint(index = 0) {\n    if (this.points.has(index)) {\n      return this.points.get(index);\n    }\n\n    const realIndex = this.isReverse ? this.config.n - 1 - index : index;\n\n    const point = [\n      this.center[0] +\n        Math.sin(realIndex * this.indexAngle + this.rotationAngle) *\n          this.radius,\n      this.center[1] +\n        Math.cos(realIndex * this.indexAngle + this.rotationAngle) *\n          this.radius,\n    ];\n\n    this.points.set(index, point);\n    return point;\n  }\n\n  setConfig(config) {\n    const serializedConfig = this._serializeConfig(config);\n    if (serializedConfig !== this.serializedConfig) {\n      const {\n        n,\n        size,\n        margin = 0,\n        rotation = 0,\n        center: configCenter,\n        radius,\n        reverse = false,\n      } = config;\n      const center = configCenter ?? size.map(v => v / 2);\n      const props = {\n        center,\n        radius: radius ?? Math.min(...center) - margin,\n        indexAngle: PI2 / n,\n        rotationAngle: -PI2 * rotation,\n        isReverse: reverse,\n      };\n      this.config = config;\n      this.serializedConfig = serializedConfig;\n      Object.assign(this, props);\n      if (this.points) {\n        this.points.clear();\n      } else {\n        this.points = new Map();\n      }\n    }\n  }\n\n  _serializeConfig({\n    n,\n    size,\n    margin = 0,\n    rotation = 0,\n    center,\n    radius,\n    reverse = false,\n  }) {\n    return [\n      size?.join(','),\n      center?.join(','),\n      radius,\n      margin,\n      n,\n      rotation,\n      reverse,\n    ].join('_');\n  }\n\n  /**\n   * Given a Nails instance, uses it to draw the nails of this Circle\n   * @param {Nails} nails\n   * @param {{nailsNumberStart?: number, getNumber?: Function}} param1\n   */\n  drawNails(nails, { nailsNumberStart = 0, getNumber } = {}) {\n    for (let i = 0; i < this.config.n; i++) {\n      nails.addNail({\n        point: this.getPoint(i),\n        number: getNumber ? getNumber(i) : i + nailsNumberStart,\n      });\n    }\n  }\n\n  static rotationConfig = Object.freeze({\n    key: 'rotation',\n    label: 'Rotation',\n    defaultValue: 0,\n    type: 'range',\n    attr: {\n      min: 0,\n      max: 1 + 1 / 360,\n      step: 1 / 360,\n    },\n    displayValue: (config, { key }) => `${Math.round(config[key] * 360)}°`,\n  });\n\n  static nailsConfig = Object.freeze({\n    key: 'n',\n    label: 'Number of nails',\n    defaultValue: 144,\n    type: 'range',\n    attr: {\n      min: 3,\n      max: 300,\n      step: 1,\n    },\n  });\n}\n","import Color from '../helpers/Color.js';\nimport StringArt from '../StringArt.js';\nimport Circle from '../helpers/Circle.js';\n\nconst COLOR_CONFIG = Color.getConfig({\n  defaults: {\n    isMultiColor: true,\n    colorCount: 7,\n    color: '#ffbb29',\n    multicolorRange: '21',\n    multicolorStart: 32,\n    multicolorByLightness: true,\n    minLightness: 36,\n    maxLightness: 98,\n  },\n});\n\nexport default class Spiral extends StringArt {\n  id = 'spiral';\n  name = 'Spiral';\n  link =\n    'https://www.etsy.com/il-en/listing/840974781/boho-wall-decor-artwork-spiral-round';\n  controls = [\n    {\n      ...Circle.nailsConfig,\n      defaultValue: 200,\n    },\n    {\n      key: 'repetition',\n      label: 'Repetition',\n      defaultValue: 6,\n      type: 'range',\n      attr: { min: 1, max: 20, step: 1 },\n    },\n    {\n      key: 'innerLength',\n      label: 'Spiral thickness',\n      defaultValue: 0.5,\n      type: 'range',\n      attr: {\n        min: ({ config: { n } }) => 1 / n,\n        max: 1,\n        step: ({ config: { n } }) => 1 / n,\n      },\n      displayValue: ({ n, innerLength }) => Math.round(n * innerLength),\n    },\n    {\n      ...Circle.rotationConfig,\n      defaultValue: 0.75,\n    },\n    COLOR_CONFIG,\n  ];\n\n  setUpDraw() {\n    super.setUpDraw();\n    const { n, rotation, layers, margin, colorCount } = this.config;\n    this.layersCount = layers ?? 1;\n\n    const circleConfig = {\n      size: this.size,\n      n,\n      margin,\n      rotation,\n    };\n\n    if (this.circle) {\n      this.circle.setConfig(circleConfig);\n    } else {\n      this.circle = new Circle(circleConfig);\n    }\n\n    this.color = new Color({\n      ...this.config,\n      colorCount: layers ?? colorCount,\n    });\n\n    if (colorCount) {\n      this.colorMap = this.color.getColorMap({\n        stepCount: this.getStepCount(),\n        colorCount,\n      });\n    }\n  }\n\n  *drawSpiral({ shift = 0, color = '#ffffff' } = {}) {\n    const { repetition, innerLength, n } = this.config;\n\n    let currentInnerLength = Math.round(innerLength * n);\n    let repetitionCount = 0;\n    this.ctx.strokeStyle = color;\n    let prevPointIndex = shift;\n    let prevPoint = this.circle.getPoint(prevPointIndex);\n    let isPrevPoint = false;\n\n    for (let i = 0; currentInnerLength > 0; i++) {\n      if (this.colorMap) {\n        const stepColor = this.colorMap.get(i);\n        if (stepColor) {\n          this.ctx.strokeStyle = stepColor;\n        }\n      }\n\n      this.ctx.beginPath();\n      this.ctx.moveTo(...prevPoint);\n      const nextPointIndex = isPrevPoint\n        ? prevPointIndex - currentInnerLength\n        : prevPointIndex + currentInnerLength;\n\n      this.ctx.lineTo(...this.circle.getPoint(nextPointIndex));\n      repetitionCount++;\n      if (repetitionCount === repetition) {\n        currentInnerLength--;\n        repetitionCount = 0;\n      }\n\n      prevPointIndex = nextPointIndex + 1;\n      prevPoint = this.circle.getPoint(prevPointIndex);\n      this.ctx.lineTo(...prevPoint);\n\n      this.ctx.stroke();\n\n      yield i;\n      isPrevPoint = !isPrevPoint;\n    }\n  }\n\n  *generateStrings() {\n    yield* this.drawSpiral({\n      color: this.color.getColor(0),\n    });\n  }\n\n  getStepCount() {\n    const { innerLength, repetition, n, layers = 1 } = this.config;\n    return layers * Math.round(innerLength * n) * repetition;\n  }\n\n  drawNails() {\n    this.circle.drawNails(this.nails);\n  }\n\n  static thumbnailConfig = {\n    n: 60,\n  };\n}\n","import StringArt from '../StringArt.js';\nimport Circle from '../helpers/Circle.js';\nimport Color from '../helpers/Color.js';\n\nclass Spirals extends StringArt {\n  name = 'Spirals';\n  id = 'spirals';\n  link =\n    'https://www.etsy.com/il-en/listing/974865185/3d-string-art-spiral-mandala-wall?ref=shop_home_active_10&frs=1';\n  controls = [\n    {\n      key: 'radiusIncrease',\n      label: 'Radius change',\n      defaultValue: 5.7,\n      type: 'range',\n      attr: { min: 1, max: 20, step: 0.1 },\n    },\n    {\n      key: 'angleStep',\n      label: 'Angle step',\n      defaultValue: 0.45,\n      type: 'range',\n      attr: { min: 0, max: 1, step: 0.01 },\n    },\n    {\n      key: 'nSpirals',\n      label: 'Number of spirals',\n      defaultValue: 3,\n      type: 'range',\n      attr: { min: 1, max: 20, step: 1 },\n    },\n    {\n      ...Circle.rotationConfig,\n      defaultValue: 330 / 360,\n    },\n    Color.getConfig({\n      defaults: {\n        isMultiColor: true,\n        colorCount: 4,\n        color: '#00d5ff',\n        multicolorRange: 1,\n        multicolorStart: 190,\n        multicolorByLightness: true,\n        minLightness: 50,\n        maxLightness: 88,\n        reverseColors: true,\n      },\n    }),\n  ];\n\n  setUpDraw() {\n    super.setUpDraw();\n\n    const {\n      nSpirals,\n      rotation,\n      margin,\n      radiusIncrease,\n      angleStep,\n      colorCount,\n    } = this.config;\n    const PI2 = Math.PI * 2;\n\n    this.spiralRotations = new Array(nSpirals)\n      .fill(null)\n      .map((_, i) => (i * PI2) / nSpirals);\n    this.rotationAngle = -PI2 * rotation;\n    const maxRadius = Math.min(...this.size) / 2 - margin;\n    this.nailsPerSpiral = Math.floor(maxRadius / radiusIncrease);\n    this.angleIncrease = angleStep / (maxRadius / 50);\n    this.color = new Color(this.config);\n    this.colorMap = this.color.getColorMap({\n      stepCount: this.getStepCount(),\n      colorCount,\n    });\n  }\n\n  *generatePoints() {\n    const { nSpirals } = this.config;\n\n    for (let i = 0; i < this.nailsPerSpiral; i++) {\n      for (let s = 0; s < nSpirals; s++) {\n        const point = this.getPoint(s, i);\n        yield { point, nailNumber: `${s}_${i}` };\n      }\n    }\n  }\n\n  getPoint(spiralIndex, index) {\n    const [centerx, centery] = this.center;\n    const { radiusIncrease } = this.config;\n\n    const angle =\n      this.rotationAngle +\n      this.angleIncrease * index +\n      this.spiralRotations[spiralIndex];\n    const radius = index * radiusIncrease;\n\n    return [\n      centerx + radius * Math.sin(angle),\n      centery + radius * Math.cos(angle),\n    ];\n  }\n\n  *generateStrings() {\n    const points = this.generatePoints();\n    let index = 0;\n    this.ctx.beginPath();\n    this.ctx.moveTo(...this.center);\n    this.ctx.strokeStyle = this.color.getColor(0);\n\n    let lastPoint;\n\n    for (const { point } of points) {\n      if (this.colorMap) {\n        const stepColor = this.colorMap.get(index);\n        if (stepColor) {\n          this.ctx.strokeStyle = stepColor;\n        }\n      }\n\n      this.ctx.beginPath();\n      if (lastPoint) {\n        this.ctx.moveTo(...lastPoint);\n        this.ctx.lineTo(...point);\n      }\n      lastPoint = point;\n      this.ctx.stroke();\n      yield index++;\n    }\n  }\n\n  getStepCount() {\n    const { nSpirals, radiusIncrease, margin } = this.config;\n    const maxRadius = Math.min(...this.getSize()) / 2 - margin;\n    const n = Math.floor(maxRadius / radiusIncrease);\n    return n * nSpirals;\n  }\n\n  drawNails() {\n    const points = this.generatePoints();\n    for (const { point, nailNumber } of points) {\n      this.nails.addNail({ point, number: nailNumber });\n    }\n  }\n\n  static thumbnailConfig = {\n    radiusIncrease: 1.4,\n    angleStep: 0.11,\n  };\n}\n\nexport default Spirals;\n","import StringArt from '../StringArt.js';\n\nconst SIDES = ['left', 'bottom', 'right', 'top'];\nconst SIDES_ORDER = ['left', 'bottom', 'right', 'top'];\n\nconst SIDES_ROTATION = {\n  left: 0,\n  bottom: Math.PI / 2,\n  right: Math.PI,\n  top: Math.PI * 1.5,\n};\n\nclass Eye extends StringArt {\n  name = 'Eye';\n  id = 'eye';\n  link =\n    'https://www.etsy.com/listing/489853161/rose-of-space-string-art-sacred-geometry?ga_order=most_relevant&ga_search_type=all&ga_view_type=gallery&ga_search_query=string+art&ref=sr_gallery_1&epik=dj0yJnU9WXNpM1BDTnNkLVBtcWdCa3AxN1J5QUZRY1FlbkJ5Z18mcD0wJm49ZXdJb2JXZmVpNVVwN1NKQ3lXMy10ZyZ0PUFBQUFBR0ZuUzZv';\n  controls = [\n    {\n      key: 'n',\n      label: 'Number of nails per side',\n      defaultValue: 82,\n      type: 'range',\n      attr: { min: 2, max: 200, step: 1 },\n    },\n    {\n      key: 'layers',\n      label: 'Layers',\n      defaultValue: 13,\n      type: 'range',\n      attr: { min: 1, max: 20, step: 1 },\n    },\n    {\n      key: 'angle',\n      label: 'Layer angle',\n      defaultValue: 30,\n      displayValue: ({ angle }) => `${angle}°`,\n      type: 'range',\n      attr: { min: 0, max: 45, step: 1 },\n    },\n    {\n      key: 'color',\n      label: 'Color',\n      type: 'group',\n      children: [\n        {\n          key: 'color1',\n          label: 'String #1 color',\n          defaultValue: '#11e8bd',\n          type: 'color',\n        },\n        {\n          key: 'color2',\n          label: 'String #2 color',\n          defaultValue: '#6fff52',\n          type: 'color',\n        },\n        {\n          key: 'colorPerLayer',\n          label: 'Color per layer',\n          defaultValue: false,\n          type: 'checkbox',\n        },\n      ],\n    },\n  ];\n\n  setUpDraw() {\n    super.setUpDraw();\n\n    const { n, angle, layers, margin } = this.config;\n\n    this.maxSize = Math.min(...this.size) - 2 * margin;\n    this.nailSpacing = this.maxSize / (n - 1);\n    this.layerAngle = (angle * Math.PI) / 180;\n\n    this.layers = new Array(layers)\n      .fill(null)\n      .map((_, layerIndex) => this._getLayerProps(layerIndex));\n  }\n\n  // Sides: top, right, bottom, left\n  getPoint({ index, angle, layerStart, rotation }) {\n    const theta = angle + rotation;\n\n    const point = {\n      x: layerStart.x,\n      y: layerStart.y + this.nailSpacing * index,\n    };\n\n    const pivot = { x: this.center[0], y: this.center[1] };\n\n    const cosAngle = Math.cos(theta);\n    const sinAngle = Math.sin(theta);\n\n    const position = [\n      cosAngle * (point.x - pivot.x) - sinAngle * (point.y - pivot.y) + pivot.x,\n      sinAngle * (point.x - pivot.x) + cosAngle * (point.y - pivot.y) + pivot.y,\n    ];\n    return position;\n  }\n\n  *drawSide({\n    side,\n    color = '#ffffff',\n    angle,\n    size,\n    layerStart,\n    layerStringCount,\n  }) {\n    const sideIndex = SIDES.indexOf(side);\n    const nextSide = SIDES[sideIndex === SIDES.length - 1 ? 0 : sideIndex + 1];\n    const rotation = SIDES_ROTATION[side];\n    const nextSideRotation = SIDES_ROTATION[nextSide];\n\n    const sideProps = { layerStringCount, size, layerStart, angle };\n\n    for (let i = 0; i <= layerStringCount; i++) {\n      this.ctx.beginPath();\n      this.ctx.moveTo(\n        ...this.getPoint({ side, index: i, rotation, ...sideProps })\n      );\n      this.ctx.lineTo(\n        ...this.getPoint({\n          side: nextSide,\n          index: i,\n          rotation: nextSideRotation,\n          ...sideProps,\n        })\n      );\n      this.ctx.strokeStyle = color;\n      this.ctx.stroke();\n      yield i;\n    }\n  }\n\n  _getLayerProps(layerIndex) {\n    const colors = this._getLayerColors(layerIndex);\n    const layerAngle = this.layerAngle * layerIndex;\n    const layerSize =\n      this.maxSize /\n      Math.pow(\n        Math.cos(this.layerAngle) + Math.sin(this.layerAngle),\n        layerIndex\n      );\n    const layerStart = {\n      x: this.center[0] - layerSize / 2,\n      y: this.center[1] - layerSize / 2,\n    };\n    const layerStringCount = Math.floor(layerSize / this.nailSpacing);\n\n    return {\n      colors,\n      layerAngle,\n      layerSize,\n      layerStart,\n      layerStringCount,\n    };\n  }\n\n  _getLayerColors(layerIndex) {\n    const { color1, color2, colorPerLayer } = this.config;\n    if (colorPerLayer) {\n      const layerColor = layerIndex % 2 ? color1 : color2;\n      return [layerColor, layerColor, layerColor, layerColor];\n    } else {\n      return [color2, color1, color2, color1];\n    }\n  }\n\n  *drawLayer(layerIndex) {\n    const { colors, layerAngle, layerSize, layerStart, layerStringCount } =\n      this.layers[layerIndex];\n\n    for (let i = 0; i < SIDES.length; i++) {\n      yield* this.drawSide({\n        color: colors[i],\n        side: SIDES_ORDER[i],\n        angle: layerAngle,\n        size: layerSize,\n        layerStart,\n        layerStringCount,\n      });\n    }\n  }\n\n  *generateStrings() {\n    const { layers } = this.config;\n    for (let layer = layers - 1; layer >= 0; layer--) {\n      yield* this.drawLayer(layer);\n    }\n  }\n\n  getStepCount() {\n    let count = 0;\n    const { layers, angle, n, margin } = this.config;\n    const layerAngle = (angle * Math.PI) / 180;\n    const maxSize =\n      Math.min(this.canvas.clientWidth, this.canvas.clientHeight) - 2 * margin;\n    const nailSpacing = maxSize / (n - 1);\n\n    for (let layer = 0; layer < layers; layer++) {\n      const layerSize =\n        maxSize / Math.pow(Math.cos(layerAngle) + Math.sin(layerAngle), layer);\n      count += 4 * (Math.floor(layerSize / nailSpacing) + 1);\n    }\n\n    return count;\n  }\n\n  drawNails() {\n    const { layers } = this.config;\n    for (let layer = layers - 1; layer >= 0; layer--) {\n      const {\n        layerAngle: angle,\n        layerSize: size,\n        layerStart,\n        layerStringCount,\n      } = this.layers[layer];\n\n      for (let s = 0; s < SIDES.length; s++) {\n        const sideOrder = SIDES_ORDER[s];\n        const rotation = SIDES_ROTATION[sideOrder];\n\n        for (let i = 0; i <= layerStringCount; i++) {\n          const sideProps = { layerStringCount, size, layerStart, angle };\n          this.nails.addNail({\n            point: this.getPoint({\n              sideOrder,\n              index: i,\n              rotation,\n              ...sideProps,\n            }),\n            number: `${layer}_${s}_${i}`,\n          });\n        }\n      }\n    }\n  }\n\n  static thumbnailConfig = {\n    n: 25,\n    layers: 7,\n  };\n}\n\nexport default Eye;\n","const PI2 = Math.PI * 2;\n\nexport default class Polygon {\n  constructor(config) {\n    this.setConfig(config);\n  }\n\n  setConfig(config) {\n    const serializedConfig = this._serializeConfig(config);\n    if (serializedConfig !== this.serializedConfig) {\n      const {\n        size: configSize,\n        margin,\n        rotation = 0,\n        sides: sideCount,\n      } = (this.config = config);\n\n      const sideAngle = PI2 / sideCount;\n\n      const sides = new Array(sideCount).fill(null).map((_, i) => {\n        const angle = sideAngle * i + PI2 * rotation;\n        const radiusAngle = -sideAngle * (i - 0.5) - PI2 * rotation;\n\n        return {\n          cos: Math.cos(angle),\n          sin: Math.sin(angle),\n          center: {\n            cos: Math.cos(radiusAngle),\n            sin: Math.sin(radiusAngle),\n          },\n        };\n      });\n\n      Object.assign(this, {\n        sides,\n        sideCount,\n        sideAngle,\n      });\n\n      if (this.points) {\n        this.points.clear();\n      } else {\n        this.points = new Map();\n      }\n\n      Object.assign(this, this._getProps());\n\n      if (config.fitSize) {\n        const boundingRect = this.getBoundingRect();\n        const scale = Math.min(\n          (configSize[0] - 2 * margin) / boundingRect.width,\n          (configSize[1] - 2 * margin) / boundingRect.height\n        );\n\n        const size = configSize.map(v => v * scale);\n        const center = [\n          this.center[0] -\n            (scale * (boundingRect.left - configSize[0] + boundingRect.right)) /\n              2,\n          this.center[1] -\n            (scale * (boundingRect.top - configSize[1] + boundingRect.bottom)) /\n              2,\n        ];\n        Object.assign(this, this._getProps({ size, center }));\n\n        this.points.clear();\n      }\n    }\n  }\n\n  _getProps(overrideConfig) {\n    const {\n      nailsSpacing,\n      size,\n      margin = 0,\n      center: configCenter,\n    } = Object.assign({}, this.config, overrideConfig);\n\n    const center = configCenter ?? this.config.size.map(v => v / 2);\n\n    const radius = Math.min(...size) / 2 - margin;\n    const sideSize = 2 * radius * Math.sin(this.sideAngle / 2);\n    const start = [\n      radius * Math.sin(this.sideAngle / 2),\n      radius * Math.cos(this.sideAngle / 2),\n    ];\n    const nailsDistance = sideSize * nailsSpacing;\n    const radiusNailsCount = Math.floor(radius / nailsDistance);\n\n    return {\n      nailsSpacing,\n      nailsPerSide: 1 / nailsSpacing,\n      center,\n      radius,\n      sideSize,\n      start,\n      nailsDistance,\n      radiusNailsCount,\n    };\n  }\n\n  _serializeConfig({ size, margin = 0, rotation = 0, center, sides }) {\n    return [size?.join(','), center?.join(','), sides, margin, rotation].join(\n      '_'\n    );\n  }\n\n  getSidePoint({ side, index }) {\n    const pointsMapIndex = [side, index].join('_');\n\n    if (this.points.has(pointsMapIndex)) {\n      return this.points.get(pointsMapIndex);\n    }\n\n    const startX = this.start[0] - index * this.nailsDistance;\n    const { cos, sin } = this.sides[side];\n\n    const point = [\n      cos * startX - sin * this.start[1] + this.center[0],\n      sin * startX + cos * this.start[1] + this.center[1],\n    ];\n\n    this.points.set(pointsMapIndex, point);\n    return point;\n  }\n\n  getCenterPoint({ side, index }) {\n    const radius = index * this.nailsDistance;\n    const { sin, cos } = this.sides[side].center;\n\n    return [this.center[0] + sin * radius, this.center[1] + cos * radius];\n  }\n\n  getBoundingRect() {\n    const points = this.sides.map((_, side) =>\n      this.getSidePoint({ side, index: 0 })\n    );\n    const firstPoint = points[0];\n\n    const boundingRect = points.slice(1).reduce(\n      (boundingRect, [x, y]) => ({\n        left: Math.min(boundingRect.left, x),\n        right: Math.max(boundingRect.right, x),\n        top: Math.min(boundingRect.top, y),\n        bottom: Math.max(boundingRect.bottom, y),\n      }),\n      {\n        left: firstPoint[0],\n        right: firstPoint[0],\n        top: firstPoint[1],\n        bottom: firstPoint[1],\n      }\n    );\n\n    boundingRect.height = boundingRect.bottom - boundingRect.top;\n    boundingRect.width = boundingRect.right - boundingRect.left;\n    Object.freeze(boundingRect);\n    return boundingRect;\n  }\n\n  drawNails(nails, { drawCenter = false, drawSides = true } = {}) {\n    for (let side = 0; side < this.sideCount; side++) {\n      const sideIndexStart = side * this.nailsPerSide;\n\n      if (drawSides) {\n        for (let index = 0; index < this.nailsPerSide; index++) {\n          nails.addNail({\n            point: this.getSidePoint({ side, index }),\n            number: sideIndexStart + index,\n          });\n        }\n      }\n\n      if (drawCenter) {\n        for (let index = 0; index < this.radiusNailsCount; index++) {\n          nails.addNail({\n            point: this.getCenterPoint({ side, index }),\n            number: `${side}_${index}`,\n          });\n        }\n      }\n    }\n  }\n}\n","import StringArt from '../StringArt.js';\nimport Circle from '../helpers/Circle.js';\nimport Polygon from '../helpers/Polygon.js';\nimport Color from '../helpers/Color.js';\n\nconst COLOR_CONFIG = Color.getConfig({\n  defaults: {\n    isMultiColor: true,\n    color: '#ff0000',\n    multicolorRange: 360,\n    multicolorStart: 0,\n    multicolorByLightness: false,\n    minLightness: 0,\n    maxLightness: 100,\n  },\n  exclude: ['colorCount'],\n});\n\nexport default class PolygonPattern extends StringArt {\n  name = 'Polygon';\n  id = 'polygon';\n  controls = [\n    {\n      key: 'sides',\n      label: 'Sides',\n      defaultValue: 5,\n      type: 'range',\n      attr: {\n        min: 3,\n        max: 10,\n        step: 1,\n      },\n    },\n    {\n      key: 'n',\n      label: 'Nails per side',\n      defaultValue: 60,\n      type: 'range',\n      attr: {\n        min: 1,\n        max: 100,\n        step: 1,\n      },\n    },\n    {\n      key: 'bezier',\n      label: 'Bezier',\n      defaultValue: 2,\n      type: 'range',\n      attr: {\n        min: 1,\n        max: 4,\n        step: 1,\n      },\n      show: ({ sides }) => sides > 4,\n    },\n    Circle.rotationConfig,\n    COLOR_CONFIG,\n  ];\n\n  setUpDraw() {\n    super.setUpDraw();\n    const { n, rotation, sides, margin, isMultiColor } = this.config;\n    const size = this.getSize();\n\n    const polygonConfig = {\n      sides,\n      rotation,\n      margin,\n      size,\n      nailsSpacing: 1 / n,\n      fitSize: true\n    };\n\n    if (this.polygon) {\n      this.polygon.setConfig(polygonConfig);\n    } else {\n      this.polygon = new Polygon(polygonConfig);\n    }\n\n    this.color = new Color({\n      ...this.config,\n      isMultiColor,\n      colorCount: sides,\n    });\n\n    if (isMultiColor) {\n      this.colorMap = this.color.getColorMap({\n        stepCount: this.getStepCount(),\n        colorCount: sides,\n      });\n    } else {\n      this.colorMap = null;\n    }\n  }\n\n  *generateStrings() {\n    const { sides, bezier } = this.config;\n    const limitedBezier = Math.min(bezier, Math.ceil(sides / 2) - 1);\n\n    let step = 0;\n    let color = this.color.getColor(0);\n\n    for (let side = 0; side < sides; side++) {\n      const nextSide = (side + limitedBezier) % sides;\n\n      for (let index = 0; index < this.polygon.nailsPerSide; index++) {\n        if (this.colorMap) {\n          color = this.colorMap.get(step);\n        }\n\n        this.ctx.strokeStyle = color;\n        this.ctx.beginPath();\n        this.ctx.moveTo(...this.polygon.getSidePoint({ side, index }));\n        this.ctx.lineTo(\n          ...this.polygon.getSidePoint({ side: nextSide, index })\n        );\n\n        this.ctx.stroke();\n\n        yield;\n        step++;\n      }\n    }\n  }\n\n  getStepCount() {\n    const { sides, n } = this.config;\n    return sides * n;\n  }\n\n  drawNails() {\n    this.polygon.drawNails(this.nails);\n  }\n\n  static thumbnailConfig = {\n    n: 20,\n  };\n}\n","import StringArt from '../StringArt.js';\nimport Circle from '../helpers/Circle.js';\nimport Polygon from '../helpers/Polygon.js';\nimport Color from '../helpers/Color.js';\n\nconst COLOR_CONFIG = Color.getConfig({\n  defaults: {\n    isMultiColor: true,\n    color: '#ffbb29',\n    multicolorRange: 345,\n    multicolorStart: 196,\n    multicolorByLightness: true,\n    minLightness: 40,\n    maxLightness: 55,\n  },\n  exclude: ['colorCount'],\n});\n\nexport default class Flower extends StringArt {\n  name = 'Flower';\n  id = 'flower';\n  link = 'https://www.sqrt.ch/Buch/fadenmodell4_100.svg';\n  controls = [\n    {\n      key: 'n',\n      label: 'Nails per side',\n      defaultValue: 60,\n      type: 'range',\n      attr: {\n        min: 1,\n        max: 100,\n        step: 1,\n      },\n    },\n    {\n      key: 'sides',\n      label: 'Sides',\n      defaultValue: 4,\n      type: 'range',\n      attr: {\n        min: 3,\n        max: 10,\n        step: 1,\n      },\n    },\n    {\n      key: 'layers',\n      label: 'Layers',\n      defaultValue: 2,\n      type: 'range',\n      attr: {\n        min: 1,\n        max: 10,\n        step: 1,\n      },\n    },\n    Circle.rotationConfig,\n    COLOR_CONFIG,\n  ];\n\n  setUpDraw() {\n    super.setUpDraw();\n    const { n, rotation, sides, layers, margin, isMultiColor } = this.config;\n    const size = this.getSize();\n\n    const layerAngleShift = 1 / (sides * layers);\n\n    this.polygons = new Array(layers).fill(null).map((_, i) => {\n      const polygonConfig = {\n        sides,\n        rotation: rotation + i * layerAngleShift,\n        margin,\n        size,\n        nailsSpacing: 1 / n,\n      };\n\n      return new Polygon(polygonConfig);\n    });\n\n    this.color = new Color({\n      ...this.config,\n      isMultiColor,\n      colorCount: layers,\n    });\n\n    if (isMultiColor) {\n      this.colorMap = this.color.getColorMap({\n        stepCount: this.getStepCount(),\n        colorCount: layers,\n      });\n    } else {\n      this.colorMap = null;\n    }\n  }\n\n  *generateStrings() {\n    const { sides, bezier } = this.config;\n\n    let step = 0;\n    let color = this.color.getColor(0);\n\n    for (let layer = 0; layer < this.polygons.length; layer++) {\n      const polygon = this.polygons[layer];\n\n      for (let side = 0; side < sides; side++) {\n          const leftSide = side === sides - 1 ? 0 : side + 1;\n\n          for (let index = 0; index < polygon.nailsPerSide; index++) {\n            if (this.colorMap) {\n              color = this.colorMap.get(step);\n            }\n\n            const centerIndexes = this.getCenterIndexes({\n              polygon,\n              sideIndex: index\n            });\n\n            this.ctx.strokeStyle = color;\n            this.ctx.beginPath();\n            this.ctx.moveTo(...polygon.getSidePoint({ side, index }));\n            this.ctx.lineTo(\n              ...polygon.getCenterPoint({\n                side: side,\n                index: centerIndexes[0],\n              })\n            );\n            this.ctx.moveTo(...polygon.getSidePoint({ side, index }));\n            this.ctx.lineTo(\n              ...polygon.getCenterPoint({\n                side: leftSide,\n                index: centerIndexes[1],\n              })\n            );\n\n            this.ctx.stroke();\n\n            yield;\n            step++;\n          }\n        }\n      }\n  }\n\n  getCenterIndexes({ polygon, sideIndex }) {\n    const extraNailCount = polygon.nailsPerSide - polygon.radiusNailsCount;\n\n    return [\n      sideIndex < extraNailCount ? -extraNailCount + sideIndex : sideIndex - extraNailCount,\n      polygon.radiusNailsCount - sideIndex\n    ];\n  }\n\n  getStepCount() {\n    const { sides, n, layers } = this.config;\n    return sides * n * layers;\n  }\n\n  drawNails() {\n    this.polygons.forEach(polygon =>\n      polygon.drawNails(this.nails, { drawCenter: true })\n    );\n  }\n\n  static thumbnailConfig = {\n    n: 20,\n  };\n}\n","import Spiral from './string_art_types/Spiral.js';\nimport Spirals from './string_art_types/Spirals.js';\nimport Wave from './string_art_types/Wave.js';\nimport Eye from './string_art_types/Eye.js';\nimport TimesTables from './string_art_types/TimesTables.js';\nimport Star from './string_art_types/Star.js';\nimport Assymetry from './string_art_types/Assymetry.js';\nimport Circles from './string_art_types/Circles.js';\nimport PolygonPattern from './string_art_types/PolygonPattern.js';\nimport Flower from './string_art_types/Flower.js';\n\nconst patternTypes = [\n  Star,\n  Assymetry,\n  TimesTables,\n  Spiral,\n  Spirals,\n  Wave,\n  Eye,\n  Circles,\n  PolygonPattern,\n  Flower,\n];\n\nexport default patternTypes;\n","import StringArt from '../StringArt.js';\nimport Circle from '../helpers/Circle.js';\n\nexport default class Star extends StringArt {\n  name = 'Star';\n  id = 'star';\n  link =\n    'https://www.etsy.com/listing/557818258/string-art-meditation-geometric-yoga?epik=dj0yJnU9Mm1hYmZKdks1eTc3bVY2TkVhS2p2Qlg0N2dyVWJxaTEmcD0wJm49MGlWSXE1SVJ2Vm0xZ0xtaGhITDBWQSZ0PUFBQUFBR0Zwd2lj';\n  controls = [\n    {\n      key: 'sides',\n      label: 'Sides',\n      defaultValue: 3,\n      type: 'range',\n      attr: { min: 3, max: 20, step: 1 },\n    },\n    {\n      key: 'sideNails',\n      label: 'Nails per side',\n      defaultValue: 40,\n      type: 'range',\n      attr: { min: 1, max: 200, step: 1 },\n    },\n    Circle.rotationConfig,\n    {\n      key: 'colorGroup',\n      label: 'Color',\n      type: 'group',\n      children: [\n        {\n          key: 'innerColor',\n          label: 'Star color',\n          defaultValue: '#2ec0ff',\n          type: 'color',\n        },\n        {\n          key: 'outterColor',\n          label: 'Outter color',\n          defaultValue: '#2a82c6',\n          type: 'color',\n        },\n      ],\n    },\n  ];\n\n  get n() {\n    if (!this._n) {\n      const { n, sides } = this.config;\n      const extraNails = n % sides;\n      this._n = n - extraNails;\n    }\n\n    return this._n;\n  }\n\n  setUpDraw() {\n    this._n = null;\n    super.setUpDraw();\n\n    const { sides, rotation, sideNails, margin = 0 } = this.config;\n    const circleConfig = {\n      size: this.size,\n      n: sideNails * sides,\n      margin,\n      rotation,\n    };\n\n    if (this.circle) {\n      this.circle.setConfig(circleConfig);\n    } else {\n      this.circle = new Circle(circleConfig);\n    }\n\n    this.sideAngle = (Math.PI * 2) / sides;\n    this.nailSpacing = this.circle.radius / sideNails;\n    this.starCenterStart = (sideNails % 1) * this.nailSpacing;\n\n    this.sides = new Array(sides).fill(null).map((_, side) => {\n      const sideAngle = side * this.sideAngle + this.circle.rotationAngle;\n      const circlePointsStart = side * sideNails;\n\n      return {\n        sinSideAngle: Math.sin(sideAngle),\n        cosSideAngle: Math.cos(sideAngle),\n        circlePointsStart,\n        circlePointsEnd: circlePointsStart + sideNails,\n      };\n    });\n  }\n\n  getStarPoint({ side, sideIndex }) {\n    const radius = this.starCenterStart + sideIndex * this.nailSpacing;\n    const { sinSideAngle, cosSideAngle } = this.sides[side];\n    const [centerX, centerY] = this.circle.center;\n\n    return [centerX + sinSideAngle * radius, centerY + cosSideAngle * radius];\n  }\n\n  *generateStarPoints({ reverseOrder = false } = {}) {\n    const { sides, sideNails } = this.config;\n\n    for (let side = 0; side < sides; side++) {\n      const prevSide = side === 0 ? sides - 1 : side - 1;\n      for (let i = 0; i < sideNails; i++) {\n        const sideIndex = reverseOrder ? sideNails - i : i;\n        yield {\n          side,\n          prevSide,\n          sideIndex,\n          point: this.getStarPoint({ side, sideIndex }),\n        };\n      }\n    }\n  }\n\n  *drawStar() {\n    const { innerColor, sideNails } = this.config;\n\n    this.ctx.strokeStyle = innerColor;\n    let prevPoint;\n\n    for (const { prevSide, sideIndex, point } of this.generateStarPoints()) {\n      this.ctx.beginPath();\n\n      if (sideIndex && !(sideIndex % 2)) {\n        this.ctx.moveTo(...prevPoint);\n        this.ctx.lineTo(...point);\n      } else {\n        this.ctx.moveTo(...point);\n      }\n\n      const prevSideIndex = sideNails - sideIndex;\n      this.ctx.lineTo(\n        ...this.getStarPoint({ side: prevSide, sideIndex: prevSideIndex })\n      );\n      prevPoint = point;\n      this.ctx.stroke();\n      yield;\n    }\n  }\n\n  *drawCircle() {\n    const { outterColor } = this.config;\n\n    let prevCirclePoint;\n    let isPrevSide = false;\n    this.ctx.strokeStyle = outterColor;\n    for (const { side, prevSide, sideIndex, point } of this.generateStarPoints({\n      reverseOrder: true,\n    })) {\n      this.ctx.beginPath();\n      if (!prevCirclePoint) {\n        prevCirclePoint = this.circle.getPoint(\n          this.sides[prevSide].circlePointsStart\n        );\n      }\n\n      this.ctx.moveTo(...prevCirclePoint);\n\n      this.ctx.lineTo(...point);\n      this.ctx.stroke();\n\n      yield;\n\n      this.ctx.beginPath();\n      this.ctx.moveTo(...point);\n      const nextPointIndex = isPrevSide\n        ? this.sides[prevSide].circlePointsEnd - sideIndex\n        : this.sides[side].circlePointsStart + sideIndex;\n\n      const nextPoint = this.circle.getPoint(nextPointIndex);\n      this.ctx.lineTo(...nextPoint);\n\n      prevCirclePoint = this.circle.getPoint(\n        isPrevSide\n          ? this.sides[prevSide].circlePointsEnd - sideIndex + 1\n          : this.sides[side].circlePointsStart + sideIndex - 1\n      );\n\n      this.ctx.lineTo(...prevCirclePoint);\n\n      this.ctx.stroke();\n      isPrevSide = !isPrevSide;\n      yield;\n    }\n  }\n\n  *generateStrings() {\n    yield* this.drawCircle();\n    yield* this.drawStar();\n  }\n\n  drawNails() {\n    this.circle.drawNails(this.nails);\n\n    for (const { point, side, sideIndex } of this.generateStarPoints()) {\n      this.nails.addNail({\n        point,\n        number: sideIndex ? `${side}_${sideIndex}` : 0,\n      });\n    }\n\n    this.circle.drawNails(this.nails);\n  }\n\n  getStepCount() {\n    const { sides, sideNails } = this.config;\n    const starCount = sideNails * sides;\n    return starCount * 3; // Once for each side + two more times for the side's circle\n  }\n\n  static thumbnailConfig = {\n    sideNails: 18,\n  };\n}\n","import StringArt from '../StringArt.js';\nimport Circle from '../helpers/Circle.js';\n\nexport default class Assymetry extends StringArt {\n  name = 'Assymetry';\n  id = 'assymetry';\n  link =\n    'https://www.etsy.com/il-en/listing/1018950430/calming-wall-art-in-light-blue-for';\n  controls = [\n    Circle.nailsConfig,\n    Circle.rotationConfig,\n    {\n      key: 'layers',\n      label: 'Layers',\n      type: 'group',\n      children: [\n        {\n          key: 'layer1',\n          label: 'Layer 1',\n          type: 'group',\n          children: [\n            {\n              key: 'show1',\n              label: 'Enable',\n              defaultValue: true,\n              type: 'checkbox',\n            },\n            {\n              key: 'size1',\n              label: 'Size',\n              defaultValue: 0.25,\n              type: 'range',\n              attr: {\n                min: 0,\n                max: 0.5,\n                step: ({ config: { n } }) => 1 / n,\n              },\n              displayValue: ({ size1, n }) => Math.round(n * size1),\n              show: ({ show1 }) => show1,\n            },\n            {\n              key: 'end1',\n              label: 'End Position',\n              defaultValue: 1,\n              type: 'range',\n              attr: {\n                min: 0,\n                max: 1,\n                step: ({ config: { n } }) => 1 / n,\n              },\n              displayValue: ({ end1, n }) => Math.round(n * end1),\n              show: ({ show1 }) => show1,\n            },\n            {\n              key: 'color1',\n              label: 'Color',\n              defaultValue: '#a94fb0',\n              type: 'color',\n              show: ({ show1 }) => show1,\n            },\n            {\n              key: 'reverse1',\n              label: 'Reverse',\n              defaultValue: false,\n              type: 'checkbox',\n              show: ({ show1 }) => show1,\n            },\n          ],\n        },\n        {\n          key: 'layer2',\n          label: 'Layer 2',\n          type: 'group',\n          children: [\n            {\n              key: 'show2',\n              label: 'Enable',\n              defaultValue: true,\n              type: 'checkbox',\n            },\n            {\n              key: 'size2',\n              label: 'Size',\n              defaultValue: 0.125,\n              type: 'range',\n              attr: {\n                min: 0,\n                max: 0.5,\n                step: ({ config: { n } }) => 1 / n,\n              },\n              displayValue: ({ size2, n }) => Math.round(n * size2),\n              show: ({ show2 }) => show2,\n            },\n            {\n              key: 'end2',\n              label: 'End Position',\n              defaultValue: 0.888,\n              type: 'range',\n              attr: {\n                min: 0,\n                max: 1,\n                step: ({ config: { n } }) => 1 / n,\n              },\n              displayValue: ({ end2, n }) => Math.round(n * end2),\n              show: ({ show2 }) => show2,\n            },\n            {\n              key: 'color2',\n              label: 'Color',\n              defaultValue: '#ec6ad0',\n              type: 'color',\n              show: ({ show2 }) => show2,\n            },\n            {\n              key: 'reverse2',\n              label: 'Reverse',\n              defaultValue: false,\n              type: 'checkbox',\n              show: ({ show2 }) => show2,\n            },\n          ],\n        },\n        {\n          key: 'layer3',\n          label: 'Layer 3',\n          type: 'group',\n          children: [\n            {\n              key: 'show3',\n              label: 'Enable',\n              defaultValue: true,\n              type: 'checkbox',\n            },\n            {\n              key: 'size3',\n              label: 'Size',\n              defaultValue: 0,\n              type: 'range',\n              attr: {\n                min: 0,\n                max: 0.5,\n                step: ({ config: { n } }) => 1 / n,\n              },\n              displayValue: ({ size3, n }) => Math.round(n * size3),\n              show: ({ show3 }) => show3,\n            },\n            {\n              key: 'end3',\n              label: 'End Position',\n              defaultValue: 0.826,\n              type: 'range',\n              attr: {\n                min: 0,\n                max: 1,\n                step: ({ config: { n } }) => 1 / n,\n              },\n              displayValue: ({ end2, n }) => Math.round(n * end2),\n              show: ({ show3 }) => show3,\n            },\n            {\n              key: 'color3',\n              label: 'Color',\n              defaultValue: '#f08ad5',\n              type: 'color',\n              show: ({ show3 }) => show3,\n            },\n            {\n              key: 'reverse3',\n              label: 'Reverse',\n              defaultValue: true,\n              type: 'checkbox',\n              show: ({ show3 }) => show3,\n            },\n          ],\n        },\n      ],\n    },\n  ];\n\n  setUpDraw() {\n    super.setUpDraw();\n    Object.assign(this, this.getSetUp());\n  }\n\n  getSetUp() {\n    const { rotation, n, margin = 0 } = this.config;\n    const size = this.getSize();\n\n    const circleConfig = {\n      size,\n      n,\n      margin,\n      rotation: rotation - 0.25,\n    };\n\n    let circle;\n    if (this.circle) {\n      circle = this.circle;\n      this.circle.setConfig(circleConfig);\n    } else {\n      circle = new Circle(circleConfig);\n    }\n\n    let lineSpacing = circle.indexAngle * circle.radius;\n    const lineNailCount = Math.floor(circle.radius / lineSpacing) - 1;\n    lineSpacing +=\n      (circle.radius - lineSpacing * lineNailCount) / lineNailCount;\n    const firstCirclePoint = circle.getPoint(0);\n    const totalNailCount = lineNailCount + n;\n    const totalIndexCount = totalNailCount + lineNailCount;\n    const layers = new Array(3)\n      .fill(null)\n      .map((_, i) => getLayer.call(this, i + 1))\n      .filter(({ enable }) => enable);\n\n    return {\n      circle,\n      lineSpacing,\n      lineNailCount,\n      firstCirclePoint,\n      layers,\n      totalNailCount,\n      totalIndexCount,\n    };\n\n    function getLayer(layerIndex) {\n      const size =\n        Math.round(n * this.config['size' + layerIndex]) + lineNailCount;\n      return {\n        size,\n        endIndex:\n          Math.round(\n            this.config['end' + layerIndex] * (totalNailCount + lineNailCount)\n          ) - size,\n        color: this.config['color' + layerIndex],\n        enable: this.config['show' + layerIndex],\n        isReverse: this.config['reverse' + layerIndex],\n      };\n    }\n  }\n\n  /**\n   * Returns the position of a point on the line\n   * @param {index of the point in the circle, 0 is the center} index\n   */\n  getPoint(index) {\n    if (index < this.lineNailCount || index > this.totalNailCount) {\n      const linePosition =\n        index < this.lineNailCount\n          ? this.lineNailCount - index\n          : index - this.totalNailCount;\n\n      const indexLength = linePosition * this.lineSpacing;\n      return [\n        this.firstCirclePoint[0] -\n          indexLength * Math.sin(this.circle.rotationAngle),\n        this.firstCirclePoint[1] -\n          indexLength * Math.cos(this.circle.rotationAngle),\n      ];\n    } else {\n      const circleIndex = index - this.lineNailCount;\n      return this.circle.getPoint(circleIndex);\n    }\n  }\n\n  *drawCircle({ endIndex, color, isReverse, size }) {\n    let prevPoint;\n    let prevPointIndex;\n    let isPrevSide = false;\n    this.ctx.strokeStyle = color;\n    const self = this;\n    const advance = isReverse ? -1 : 1;\n\n    for (let index = 0; index <= endIndex; index++) {\n      this.ctx.beginPath();\n\n      if (prevPoint) {\n        this.ctx.moveTo(...prevPoint);\n        this.ctx.lineTo(...this.getPoint(prevPointIndex + advance));\n      } else {\n        this.ctx.moveTo(...this.getPoint(getPointIndex(index)));\n      }\n\n      prevPointIndex = getPointIndex(isPrevSide ? index : index + size);\n      prevPoint = this.getPoint(prevPointIndex);\n      this.ctx.lineTo(...prevPoint);\n      this.ctx.stroke();\n\n      yield;\n\n      isPrevSide = !isPrevSide;\n    }\n\n    function getPointIndex(index) {\n      return isReverse ? self.totalIndexCount - index : index;\n    }\n  }\n\n  *generateStrings() {\n    for (const layer of this.layers) {\n      yield* this.drawCircle(layer);\n    }\n  }\n\n  drawNails() {\n    this.circle.drawNails(this.nails, { nailsNumberStart: this.lineNailCount });\n\n    for (let i = 0; i < this.lineNailCount; i++) {\n      this.nails.addNail({ point: this.getPoint(i), number: i });\n    }\n  }\n\n  getStepCount() {\n    const { layers } = this.getSetUp();\n    return layers.reduce(\n      (stepCount, layer) => stepCount + layer.endIndex + 1,\n      0\n    );\n  }\n\n  static thumbnailConfig = {\n    n: 50,\n  };\n}\n","import Color from '../helpers/Color.js';\nimport StringArt from '../StringArt.js';\nimport Circle from '../helpers/Circle.js';\n\nexport default class TimesTables extends StringArt {\n  name = 'Times Tables';\n  id = 'times_tables';\n  link =\n    'https://www.youtube.com/watch?v=LWin7w9hF-E&ab_channel=Jorgedelatierra';\n  controls = [\n    {\n      key: 'n',\n      label: 'Number of nails',\n      defaultValue: 180,\n      type: 'range',\n      attr: { min: 3, max: 240, step: 1 },\n    },\n    {\n      key: 'base',\n      label: 'Multiplication',\n      defaultValue: 2,\n      type: 'range',\n      attr: { min: 2, max: 99, step: 1 },\n    },\n    {\n      key: 'layers',\n      label: 'Layers',\n      defaultValue: 7,\n      type: 'range',\n      attr: { min: 1, max: 20, step: 1 },\n    },\n    Circle.rotationConfig,\n    Color.getConfig({\n      defaults: {\n        isMultiColor: true,\n        multicolorRange: 180,\n        multicolorStart: 256,\n        color: '#ff4d00',\n      },\n      exclude: ['colorCount'],\n    }),\n  ];\n\n  get n() {\n    if (!this._n) {\n      const { n, layers } = this.config;\n      const extraNails = n % layers;\n      this._n = n - extraNails; // The number of nails should be a multiple of the layers, so the strings are exactly on the nails.\n    }\n\n    return this._n;\n  }\n\n  setUpDraw() {\n    this._n = null;\n    super.setUpDraw();\n\n    const { layers, rotation, margin } = this.config;\n    const circleConfig = {\n      size: this.size,\n      n: this.n,\n      margin,\n      rotation,\n    };\n\n    if (this.circle) {\n      this.circle.setConfig(circleConfig);\n    } else {\n      this.circle = new Circle(circleConfig);\n    }\n\n    this.color = new Color({\n      ...this.config,\n      colorCount: layers,\n    });\n\n    this.layerShift = Math.floor(this.n / layers);\n  }\n\n  *drawTimesTable({ shift = 0, color = '#f00', steps, time }) {\n    const { base } = this.config;\n    const n = this.n;\n    const stepsToRender = steps ?? n;\n\n    let point = this.circle.getPoint(shift);\n\n    for (let i = 1; i <= stepsToRender; i++) {\n      this.ctx.beginPath();\n      this.ctx.moveTo(...point);\n      point = this.circle.getPoint(i + shift);\n      this.ctx.lineTo(...point);\n      const toIndex = (i * base) % n;\n      this.ctx.lineTo(...this.circle.getPoint(toIndex + shift));\n      this.ctx.strokeStyle = color;\n      this.ctx.stroke();\n\n      yield {\n        instructions: `${i - 1} → ${i} → ${toIndex} → ${i}`,\n        index: time * n + i,\n      };\n    }\n  }\n\n  *generateStrings() {\n    const { layers } = this.config;\n\n    for (let time = 0; time < layers; time++) {\n      const color = this.color.getColor(time);\n      yield* this.drawTimesTable({\n        time,\n        color,\n        shift: this.layerShift * time,\n      });\n    }\n  }\n\n  drawNails() {\n    this.circle.drawNails(this.nails);\n  }\n\n  getStepCount() {\n    return this.config.layers * this.n;\n  }\n\n  static thumbnailConfig = {\n    n: 70,\n  };\n}\n","import Color from '../helpers/Color.js';\nimport Circle from '../helpers/Circle.js';\nimport Spiral from './Spiral.js';\n\nexport default class Wave extends Spiral {\n  id = 'wave';\n  name = 'Wave';\n  link =\n    'https://www.etsy.com/il-en/listing/943140543/personalized-gift-string-art-mandala?ref=sim_rv-5&pro=1';\n  controls = [\n    {\n      ...Circle.nailsConfig,\n      defaultValue: 144,\n    },\n    {\n      key: 'repetition',\n      label: 'Repetition',\n      defaultValue: 2,\n      type: 'range',\n      attr: { min: 1, max: 20, step: 1 },\n    },\n    {\n      key: 'innerLength',\n      label: 'Spiral thickness',\n      defaultValue: 0.5,\n      type: 'range',\n      attr: {\n        min: ({ config: { n } }) => 1 / n,\n        max: 1,\n        step: ({ config: { n } }) => 1 / n,\n      },\n      displayValue: ({ n, innerLength }) => Math.round(n * innerLength),\n    },\n    {\n      ...Circle.rotationConfig,\n      defaultValue: 176 / 360,\n    },\n    {\n      key: 'layers',\n      label: 'Layers',\n      defaultValue: 11,\n      type: 'range',\n      attr: { min: 1, max: 20, step: 1 },\n    },\n    {\n      key: 'layerSpread',\n      label: 'Layer spread',\n      defaultValue: 0.075,\n      type: 'range',\n      attr: {\n        min: 0,\n        max: 1,\n        step: ({ config: { n } }) => 1 / n,\n      },\n      displayValue: ({ layerSpread, n }) => Math.round(layerSpread * n),\n    },\n    Color.getConfig({\n      defaults: {\n        isMultiColor: true,\n        multicolorRange: 216,\n        multicolorStart: 263,\n        color: '#ffffff',\n        multicolorByLightness: true,\n        minLightness: 10,\n        maxLightness: 90,\n      },\n      exclude: ['colorCount'],\n    }),\n  ];\n\n  setUpDraw() {\n    super.setUpDraw();\n    const { n, layerSpread } = this.config;\n    this.layerShift = Math.round(n * layerSpread);\n  }\n\n  *generateStrings() {\n    for (let layer = 0; layer < this.layersCount; layer++) {\n      yield* this.drawSpiral({\n        color: this.color.getColor(layer),\n        shift: -this.layerShift * layer,\n      });\n    }\n  }\n\n  static thumbnailConfig = {\n    n: 40,\n  };\n}\n","import StringArt from '../StringArt.js';\nimport Circle from '../helpers/Circle.js';\n\nexport default class Circles extends StringArt {\n  name = 'Circles';\n  id = 'circles';\n  link =\n    'https://www.etsy.com/il-en/listing/1018950430/calming-wall-art-in-light-blue-for';\n  controls = [\n    {\n      key: 'n',\n      label: 'Circle nails',\n      defaultValue: 80,\n      type: 'range',\n      attr: { min: 1, max: 300, step: 1 },\n    },\n    {\n      key: 'minNailDistance',\n      label: 'Min nail distance',\n      defaultValue: 20,\n      type: 'range',\n      attr: { min: 1, max: 300, step: 1 },\n    },\n    {\n      key: 'color',\n      label: 'Color',\n      defaultValue: '#ec6ad0',\n      type: 'color',\n    },\n    {\n      key: 'layers',\n      label: 'Layers',\n      type: 'group',\n      children: [\n        {\n          key: 'layer1',\n          label: 'Layer 1',\n          type: 'group',\n          children: [\n            {\n              key: 'show1',\n              label: 'Enable',\n              defaultValue: true,\n              type: 'checkbox',\n            },\n            {\n              key: 'radius1',\n              label: 'Radius',\n              defaultValue: 0.5,\n              type: 'range',\n              attr: { min: 0.01, max: 1, step: 0.01 },\n              show: ({ show1 }) => show1,\n            },\n            {\n              key: 'x1',\n              label: 'Position X',\n              defaultValue: 0.5,\n              type: 'range',\n              attr: { min: 0, max: 1, step: 0.01 },\n              show: ({ show1 }) => show1,\n            },\n            {\n              key: 'y1',\n              label: 'Position Y',\n              defaultValue: 0,\n              type: 'range',\n              attr: { min: 0, max: 1, step: 0.01 },\n              show: ({ show1 }) => show1,\n            },\n            {\n              ...Circle.rotationConfig,\n              key: 'rotation1',\n              show: ({ show1 }) => show1,\n            },\n            {\n              key: 'reverse1',\n              label: 'Reverse',\n              defaultValue: false,\n              type: 'checkbox',\n              show: ({ show1 }) => show1,\n            },\n          ],\n        },\n        {\n          key: 'layer2',\n          label: 'Layer 2',\n          type: 'group',\n          children: [\n            {\n              key: 'show2',\n              label: 'Enable',\n              defaultValue: true,\n              type: 'checkbox',\n            },\n            {\n              key: 'radius2',\n              label: 'Radius',\n              defaultValue: 0.5,\n              type: 'range',\n              attr: { min: 0.01, max: 1, step: 0.01 },\n              show: ({ show2 }) => show2,\n            },\n            {\n              key: 'x2',\n              label: 'Position X',\n              defaultValue: 0,\n              type: 'range',\n              attr: { min: 0, max: 1, step: 0.01 },\n              show: ({ show2 }) => show2,\n            },\n            {\n              key: 'y2',\n              label: 'Position Y',\n              defaultValue: 1,\n              type: 'range',\n              attr: { min: 0, max: 1, step: 0.01 },\n              show: ({ show2 }) => show2,\n            },\n            {\n              ...Circle.rotationConfig,\n              key: 'rotation2',\n              show: ({ show2 }) => show2,\n            },\n            {\n              key: 'reverse2',\n              label: 'Reverse',\n              defaultValue: false,\n              type: 'checkbox',\n              show: ({ show2 }) => show2,\n            },\n          ],\n        },\n        {\n          key: 'layer3',\n          label: 'Layer 3',\n          type: 'group',\n          children: [\n            {\n              key: 'show3',\n              label: 'Enable',\n              defaultValue: true,\n              type: 'checkbox',\n            },\n            {\n              key: 'radius3',\n              label: 'Radius',\n              defaultValue: 0.5,\n              type: 'range',\n              attr: { min: 0.01, max: 1, step: 0.01 },\n              show: ({ show3 }) => show3,\n            },\n            {\n              key: 'x3',\n              label: 'Position X',\n              defaultValue: 1,\n              type: 'range',\n              attr: { min: 0, max: 1, step: 0.01 },\n              show: ({ show3 }) => show3,\n            },\n            {\n              key: 'y3',\n              label: 'Position Y',\n              defaultValue: 1,\n              type: 'range',\n              attr: { min: 0, max: 1, step: 0.01 },\n              show: ({ show3 }) => show3,\n            },\n            {\n              ...Circle.rotationConfig,\n              key: 'rotation3',\n              show: ({ show3 }) => show3,\n            },\n            {\n              key: 'reverse3',\n              label: 'Reverse',\n              defaultValue: false,\n              type: 'checkbox',\n              show: ({ show3 }) => show3,\n            },\n          ],\n        },\n      ],\n    },\n  ];\n\n  setUpDraw() {\n    super.setUpDraw();\n    Object.assign(this, this.getSetUp());\n  }\n\n  getSetUp() {\n    const { n, margin = 0, minNailDistance } = this.config;\n    const size = this.getSize();\n\n    const maxRadius = Math.min(...size.map(v => v - 2 * margin)) / 2;\n    const layers = new Array(3)\n      .fill(null)\n      .map((_, i) => getLayer.call(this, i + 1))\n      .filter(({ enable }) => enable);\n\n    const maxShapeNailsCount = Math.max(\n      ...layers.map(({ circle }) => circle.config.n)\n    );\n\n    return {\n      layers,\n      maxShapeNailsCount,\n    };\n\n    function getLayer(layerIndex) {\n      const prop = prop => this.config[prop + layerIndex];\n\n      const props = {\n        enable: prop('show'),\n        isReverse: prop('reverse'),\n        position: [prop('x'), prop('y')],\n        radius: maxRadius * prop('radius'),\n        rotation: prop('rotation'),\n      };\n\n      const circumsference = Math.PI * 2 * props.radius;\n      const circleNails = Math.min(\n        n,\n        Math.floor(circumsference / minNailDistance)\n      );\n\n      const circle = new Circle({\n        radius: props.radius,\n        center: props.position.map(\n          (v, i) =>\n            props.radius + margin + (size[i] - (props.radius + margin) * 2) * v\n        ),\n        n: circleNails,\n        rotation: props.rotation,\n        reverse: props.isReverse,\n      });\n\n      return {\n        circle,\n        ...props,\n      };\n    }\n  }\n\n  getPoint(layer, index) {\n    const { circle } = layer;\n    let circleIndex = Math.round(\n      (index * circle.config.n) / this.maxShapeNailsCount\n    );\n    return circle.getPoint(circleIndex);\n  }\n\n  *generateStrings() {\n    const { n, color } = this.config;\n\n    this.ctx.strokeStyle = color;\n    let prevCirclePoint;\n\n    for (let i = 0; i < this.maxShapeNailsCount; i++) {\n      for (let layerIndex = 0; layerIndex < this.layers.length; layerIndex++) {\n        const layer = this.layers[layerIndex];\n        this.ctx.beginPath();\n        this.ctx.moveTo(...(prevCirclePoint ?? this.getPoint(layer, i)));\n\n        if (layerIndex === 0 && i) {\n          this.ctx.lineTo(...this.getPoint(layer, i));\n        }\n\n        let nextLayerIndex = layerIndex + 1;\n        if (nextLayerIndex === this.layers.length) {\n          nextLayerIndex = 0;\n        }\n\n        prevCirclePoint = this.getPoint(this.layers[nextLayerIndex], i);\n        this.ctx.lineTo(...prevCirclePoint);\n        this.ctx.stroke();\n        yield;\n      }\n    }\n  }\n\n  drawNails() {\n    const n = this.config;\n    this.layers.forEach(({ circle }, layerIndex) =>\n      circle.drawNails(this.nails, {\n        getNumber: i => `${layerIndex + 1}_${i + 1}`,\n      })\n    );\n  }\n\n  getStepCount() {\n    const { layers, maxShapeNailsCount } = this.getSetUp();\n    return layers.length * maxShapeNailsCount - 1;\n  }\n\n  static thumbnailConfig = {\n    minNailDistance: 3,\n  };\n}\n","const elements = {\n  controls: document.querySelector('#controls'),\n  controlsPanel: document.querySelector('#controls_panel'),\n  sidebarForm: document.querySelector('#sidebar_form'),\n};\n\nconst EVENTS = new Set(['input', 'change']);\nconst STATE_LOCAL_STORAGE_KEY = 'controls_state';\nconst RANGE_SCROLL_LOCK_TIMEOUT = 120;\n\nlet inputTimeout;\n\nexport default class EditorControls {\n  constructor({ pattern }) {\n    this.pattern = pattern;\n    this.state = this._getState() ?? { groups: {} };\n\n    this.eventHandlers = {\n      input: new Set(),\n      change: new Set(),\n    };\n\n    this._toggleFieldset = e => {\n      if (e.target.nodeName === 'LEGEND') {\n        e.target.parentElement.classList.toggle('minimized');\n        const groupId = e.target.parentElement.dataset.group;\n        this.state = {\n          ...this.state,\n          groups: {\n            ...this.state.groups,\n            [groupId]: !e.target.parentElement.classList.contains('minimized'),\n          },\n        };\n        this._updateState(this.state);\n      }\n    };\n\n    this._toggleFieldSetOnEnter = e => {\n      if (e.target.nodeName === 'LEGEND' && e.key === 'Enter') {\n        this._toggleFieldset(e);\n      }\n    };\n\n    this._wrappedOnInput = e => this._onInput(e);\n    elements.controls.addEventListener('input', this._wrappedOnInput);\n\n    this._wrappedOnTouchStart = e => this._onTouchStart(e);\n    elements.controls.addEventListener('touchstart', this._wrappedOnTouchStart);\n    elements.sidebarForm.addEventListener('click', this._toggleFieldset);\n    elements.sidebarForm.addEventListener(\n      'keydown',\n      this._toggleFieldSetOnEnter\n    );\n    this.controlElements = {};\n    this.renderControls();\n  }\n\n  destroy() {\n    elements.controls.removeEventListener('input', this._wrappedOnInput);\n    elements.sidebarForm.removeEventListener('click', this._toggleFieldset);\n    elements.sidebarForm.removeEventListener(\n      'keydown',\n      this._toggleFieldSetOnEnter\n    );\n    elements.controls.innerHTML = '';\n  }\n\n  addEventListener(event, eventHandler) {\n    if (!EVENTS.has(event)) {\n      throw new Error(`Unsupported event for EditorControls, \"${event}\"!`);\n    }\n\n    if (!(eventHandler instanceof Function)) {\n      throw new Error('Invalid event handler.');\n    }\n\n    this.eventHandlers[event].add(eventHandler);\n  }\n\n  _triggerEvent(event, eventData) {\n    for (const eventHandler of this.eventHandlers[event]) {\n      eventHandler(eventData);\n    }\n  }\n\n  /**\n   * Needed for range inputs, to avoid changing the value when the user drags to\n   * scroll and accidentally touches a range input when intending to scroll.\n   * @param {Event} e\n   */\n  _onTouchStart(e) {\n    if (e.target.getAttribute('type') === 'range') {\n      this._postponeRangeInput = true;\n      this.currentInputRange = e.target;\n      this.currentInputRangeValue = e.target.value;\n      this._rangeLockTimeout = setTimeout(() => {\n        this._postponeRangeInput = false;\n      }, RANGE_SCROLL_LOCK_TIMEOUT);\n      this._wrappedOnTouchEnd = e => this._onTouchEnd(e);\n      document.body.addEventListener('touchend', this._wrappedOnTouchEnd);\n      this._wrappedOnRangeScroll = e => this._onRangeScroll(e);\n      elements.controlsPanel.addEventListener(\n        'scroll',\n        this._wrappedOnRangeScroll\n      );\n    }\n  }\n\n  _onTouchEnd(e) {\n    document.body.removeEventListener('touchend', this._wrappedOnTouchEnd);\n    elements.controlsPanel.removeEventListener(\n      'scroll',\n      this._wrappedOnRangeScroll\n    );\n\n    if (this._lockRange) {\n      this._lockRange = false;\n      this.currentInputRange.value = this.currentInputRangeValue;\n    }\n\n    this.currentInputRange = this.currentInputRangeValue = null;\n  }\n\n  _onRangeScroll(e) {\n    this._lockRange = true;\n  }\n\n  _onInput(e) {\n    clearTimeout(inputTimeout);\n    clearTimeout(this._postponeRangeInputTimeout);\n\n    if (this._postponeRangeInput && e.target.getAttribute('type') === 'range') {\n      e.preventDefault();\n      this._postponeRangeInputTimeout = setTimeout(() => {\n        this._onInput(e);\n      }, RANGE_SCROLL_LOCK_TIMEOUT);\n      return false;\n    }\n    if (this._lockRange) {\n      e.preventDefault();\n      return false;\n    }\n\n    this.updateInput({\n      inputElement: e.target,\n      originalEvent: e,\n      deferChange: true,\n    });\n  }\n\n  updateInput({ inputElement, originalEvent, deferChange = true }) {\n    const inputValue = getInputValue(inputElement.type, inputElement);\n    const controlKey = inputElement.id.replace(/^config_/, '');\n\n    this.pattern.config = Object.freeze({\n      ...this.pattern.config,\n      [controlKey]: inputValue,\n    });\n\n    const { config, displayValue } = this.controlElements[controlKey];\n    if (displayValue) {\n      const formattedValue = config.displayValue\n        ? config.displayValue(this.pattern.config, config)\n        : inputElement.value;\n      displayValue.innerText = formattedValue;\n    }\n\n    const eventData = Object.freeze({\n      control: controlKey,\n      value: inputValue,\n      originalEvent,\n      pattern: this.pattern,\n    });\n\n    this._triggerEvent('input', eventData);\n\n    const triggerChange = () => {\n      this._triggerEvent('change', eventData);\n      this.updateControlsVisibility();\n    };\n\n    if (deferChange) {\n      inputTimeout = setTimeout(triggerChange, 100);\n    } else {\n      triggerChange();\n    }\n  }\n\n  _getState() {\n    const state = localStorage.getItem(STATE_LOCAL_STORAGE_KEY);\n    if (state) {\n      try {\n        return JSON.parse(state);\n      } catch (e) {\n        return null;\n      }\n    }\n\n    return null;\n  }\n\n  _updateState(newState) {\n    if (newState) {\n      localStorage.setItem(STATE_LOCAL_STORAGE_KEY, JSON.stringify(newState));\n    } else {\n      localStorage.removeItem(STATE_LOCAL_STORAGE_KEY);\n    }\n  }\n\n  updateControlsVisibility(configControls = this.pattern.configControls) {\n    configControls.forEach(control => {\n      if (control.show) {\n        const shouldShowControl = control.show(this.pattern.config);\n        const controlEl = this.controlElements[control.key].control;\n        if (controlEl) {\n          if (shouldShowControl) {\n            controlEl.removeAttribute('hidden');\n          } else {\n            controlEl.setAttribute('hidden', 'hidden');\n          }\n        }\n      }\n\n      if (control.isDisabled) {\n        const shouldDisableControl = control.isDisabled(this.pattern.config);\n        const inputEl = this.controlElements[control.key].input;\n        if (inputEl) {\n          if (shouldDisableControl) {\n            inputEl.setAttribute('disabled', 'disabled');\n          } else {\n            inputEl.removeAttribute('disabled');\n          }\n        }\n      }\n\n      if (control.children) {\n        this.updateControlsVisibility(control.children);\n      }\n    });\n  }\n\n  updateInputs(config) {\n    Object.entries(config).forEach(([key, value]) => {\n      const { input, value: valueEl } = this.controlElements[key];\n      if (input) {\n        if (input.type === 'checkbox') {\n          input.checked = value;\n        } else {\n          input.value = value;\n        }\n        if (valueEl) {\n          valueEl.innerText = value;\n        }\n      }\n    });\n  }\n\n  renderControls(containerEl = elements.controls, _configControls) {\n    const configControls = _configControls ?? this.pattern.configControls;\n    containerEl.innerHTML = '';\n    const controlsFragment = document.createDocumentFragment();\n\n    configControls.forEach(control => {\n      const controlId = `config_${control.key}`;\n      const controlElements = (this.controlElements[control.key] = {\n        config: control,\n      });\n\n      let controlEl;\n\n      if (control.type === 'group') {\n        controlEl = document.createElement('fieldset');\n        controlEl.setAttribute('data-group', control.key);\n        const groupTitleEl = document.createElement('legend');\n        groupTitleEl.setAttribute('tabindex', '0');\n        groupTitleEl.innerText = control.label;\n        controlEl.appendChild(groupTitleEl);\n        controlEl.className = 'control control_group';\n        if (control.defaultValue === 'minimized') {\n          controlEl.classList.add('minimized');\n          this.state.groups[control.key] = false;\n        }\n        const childrenContainer = document.createElement('div');\n        controlEl.appendChild(childrenContainer);\n        this.renderControls(childrenContainer, control.children);\n      } else {\n        controlEl = document.createElement('div');\n        controlEl.className = 'control';\n\n        const label = document.createElement('label');\n        label.innerHTML = control.label;\n        label.setAttribute('for', controlId);\n\n        const inputEl = (controlElements.input =\n          document.createElement('input'));\n        inputEl.setAttribute('type', control.type);\n        const inputValue =\n          this.pattern.config[control.key] ?? control.defaultValue;\n\n        if (control.attr) {\n          Object.entries(control.attr).forEach(([attr, value]) => {\n            const realValue =\n              value instanceof Function ? value(this.pattern) : value;\n            inputEl.setAttribute(attr, realValue);\n          });\n        }\n\n        if (control.type === 'checkbox') {\n          inputEl.checked = inputValue;\n          controlEl.appendChild(inputEl);\n          controlEl.appendChild(label);\n        } else {\n          controlEl.appendChild(label);\n          controlEl.appendChild(inputEl);\n          inputEl.value = inputValue;\n          const inputValueEl = (controlElements.displayValue =\n            document.createElement('span'));\n          inputValueEl.id = `config_${control.key}_value`;\n          inputValueEl.innerText = control.displayValue\n            ? control.displayValue(this.pattern.config, control)\n            : inputValue;\n          inputValueEl.className = 'control_input_value';\n          controlEl.appendChild(inputValueEl);\n        }\n        inputEl.id = controlId;\n      }\n\n      this.controlElements[control.key].control = controlEl;\n      controlEl.id = `control_${control.key}`;\n      controlsFragment.appendChild(controlEl);\n    });\n\n    containerEl.appendChild(controlsFragment);\n    this.updateGroupsState();\n    requestAnimationFrame(() => this.updateControlsVisibility());\n  }\n\n  updateGroupsState() {\n    const groups = elements.sidebarForm.querySelectorAll('[data-group]');\n    groups.forEach(groupEl => {\n      const groupId = groupEl.dataset.group;\n      const groupState = this.state.groups[groupId];\n      if (typeof groupState === 'boolean') {\n        if (groupState) {\n          groupEl.classList.remove('minimized');\n        } else {\n          groupEl.classList.add('minimized');\n        }\n      }\n    });\n  }\n}\n\nfunction getInputValue(type, inputElement) {\n  switch (type) {\n    case 'range':\n      return parseFloat(inputElement.value);\n    case 'checkbox':\n      return inputElement.checked;\n    case 'number':\n      return parseFloat(inputElement.value);\n    default:\n      return inputElement.value;\n  }\n}\n","const sizeControls = document.querySelector('#size_controls');\n\nconst elements = {\n  sizeSelect: sizeControls.querySelector('#size_select'),\n  sizeCustom: sizeControls.querySelector('#size_custom'),\n  width: sizeControls.querySelector('#size_custom_width'),\n  height: sizeControls.querySelector('#size_custom_height'),\n  orientationSelect: sizeControls.querySelector('#size_orientation_select'),\n};\n\nfunction cmToPixels(cm, dpi = 300) {\n  return Math.floor((cm / 2.54) * dpi);\n}\n\nconst SCREEN_SIZE = [\n  Math.floor(window.screen.width),\n  Math.floor(window.screen.height),\n];\n\nconst SIZES = [\n  { id: 'fit', name: 'Fit to screen' },\n  {\n    id: 'A4',\n    value: [20, 28].map(v => cmToPixels(v)),\n    orientationSelect: true,\n  },\n  {\n    id: 'A3',\n    value: [28, 40].map(v => cmToPixels(v)),\n    orientationSelect: true,\n  },\n  {\n    id: 'screen',\n    name: `Screen size (${SCREEN_SIZE.join('x')})`,\n    value: SCREEN_SIZE,\n  },\n  { id: 'custom', name: 'Custom...' },\n];\n\nexport default class EditorSizeControls {\n  element = document.querySelector('#size_controls');\n\n  constructor({ getCurrentSize }) {\n    const sizeOptionsFragment = document.createDocumentFragment();\n    SIZES.forEach(size => {\n      const sizeListItem = document.createElement('option');\n      sizeListItem.setAttribute('value', size.id);\n      sizeListItem.innerText = size.name ?? size.id;\n      sizeOptionsFragment.appendChild(sizeListItem);\n    });\n    elements.sizeSelect.appendChild(sizeOptionsFragment);\n    this.selectedSize = SIZES[0];\n\n    elements.sizeSelect.addEventListener('change', e => {\n      const selectedSizeId = e.target.value;\n      const size = SIZES.find(({ id }) => id === selectedSizeId);\n      this.selectedSize = size;\n\n      if (size.id === 'custom') {\n        elements.sizeCustom.removeAttribute('hidden');\n        const [width, height] = getCurrentSize();\n        elements.width.value = width;\n        elements.height.value = height;\n      } else {\n        elements.sizeCustom.setAttribute('hidden', 'hidden');\n        this._notifyOnChange(this.getValue());\n      }\n\n      if (size.orientationSelect) {\n        elements.orientationSelect.removeAttribute('hidden');\n      } else {\n        elements.orientationSelect.setAttribute('hidden', 'hidden');\n      }\n    });\n\n    elements.orientationSelect.addEventListener('change', e => {\n      this._notifyOnChange(this.getValue());\n    });\n\n    elements.sizeCustom.addEventListener('focusin', e => {\n      e.target.select();\n    });\n\n    elements.sizeCustom.addEventListener('input', () => {\n      this._notifyOnChange([\n        elements.width.value ? parseInt(elements.width.value) : null,\n        elements.height.value ? parseInt(elements.height.value) : null,\n      ]);\n    });\n  }\n\n  _notifyOnChange([width, height] = []) {\n    this.element.dispatchEvent(\n      new CustomEvent('sizechange', { detail: { width, height } })\n    );\n  }\n\n  getValue() {\n    if (this.selectedSize.id === 'custom') {\n      return [\n        parseInt(elements.width.value, 10),\n        parseInt(elements.height.value, 10),\n      ];\n    } else {\n      let value = this.selectedSize.value;\n      if (\n        this.selectedSize.orientationSelect &&\n        elements.orientationSelect.value === 'horizontal'\n      ) {\n        value = Array.from(value).reverse();\n      }\n      return value;\n    }\n  }\n}\n","import Player from './editor/Player.js';\nimport patternTypes from './pattern_types.js';\nimport EditorControls from './editor/EditorControls.js';\nimport EditorSizeControls from './editor/EditorSizeControls.js';\nimport { Thumbnails } from './thumbnails/Thumbnails.js';\n\nconst elements = {\n  canvas: document.querySelector('canvas'),\n  patternLink: document.querySelector('#pattern_link'),\n  downloadBtn: document.querySelector('#download_btn'),\n  downloadNailsBtn: document.querySelector('#download_nails_btn'),\n  resetBtn: document.querySelector('#reset_btn'),\n  buttons: document.querySelector('#buttons'),\n};\n\nconst patterns = patternTypes.map(Pattern => new Pattern(elements.canvas));\n\nlet currentPattern;\nconst player = new Player(document.querySelector('#player'));\nconst sizeControls = new EditorSizeControls({\n  getCurrentSize: () => [\n    elements.canvas.clientWidth,\n    elements.canvas.clientHeight,\n  ],\n});\n\nconst thumbnails = new Thumbnails();\n\nlet controls;\nlet activeDialog;\n\nwindow.addEventListener('load', main);\n\nfunction main() {\n  initRouting();\n  initSize();\n\n  if (history.state?.pattern) {\n    updateState(history.state);\n  } else {\n    const queryParams = new URLSearchParams(document.location.search);\n    const queryPattern = queryParams.get('pattern');\n\n    if (queryPattern) {\n      const config = queryParams.get('config');\n      updateState({ pattern: queryPattern, config });\n    } else {\n      selectPattern(patterns[0]);\n    }\n  }\n\n  window.addEventListener('resize', () => currentPattern.draw());\n\n  elements.canvas.addEventListener('click', () => {\n    player.toggle();\n  });\n\n  elements.downloadBtn.addEventListener('click', downloadCanvas);\n  elements.downloadNailsBtn.addEventListener('click', downloadNailsImage);\n  elements.resetBtn.addEventListener('click', reset);\n\n  thumbnails.addOnChangeListener(({ detail }) => {\n    const pattern = findPatternById(detail.pattern);\n    setCurrentPattern(pattern);\n  });\n\n  document.body.addEventListener('click', e => {\n    const toggleBtn = e.target.closest('[data-toggle-for]');\n    if (toggleBtn) {\n      const dialogId = toggleBtn.dataset.toggleFor;\n\n      toggleBtn.classList.toggle('active');\n      const toggledElement = document.querySelector('#' + dialogId);\n      toggledElement.classList.toggle('open');\n      document.body.classList.toggle('dialog_' + dialogId);\n      currentPattern.draw({ position: currentPattern.position });\n    }\n  });\n}\n\nfunction downloadCanvas() {\n  const downloadLink = document.createElement('a');\n  downloadLink.download = currentPattern.name + '.png';\n  downloadLink.href = elements.canvas.toDataURL('image/png');\n  downloadLink.setAttribute('target', 'download');\n  downloadLink.click();\n}\n\nfunction downloadNailsImage() {\n  const currentConfig = currentPattern.config;\n  currentPattern.config = {\n    darkMode: false,\n    showNails: true,\n    showNailNumbers: true,\n    showStrings: false,\n    nailsColor: '#000000',\n  };\n  currentPattern.draw();\n  downloadCanvas();\n\n  // Reset to the config before the download:\n  currentPattern.config = currentConfig;\n  currentPattern.draw();\n}\n\nfunction reset() {\n  if (confirm('Are you sure you wish to reset options to defaults?')) {\n    setCurrentPattern(currentPattern, { config: {} });\n  }\n}\n\nfunction onInputsChange({ withConfig = true } = {}) {\n  player.update(currentPattern);\n  const configQuery = withConfig ? JSON.stringify(currentPattern.config) : null;\n  history.replaceState(\n    {\n      pattern: currentPattern.id,\n      config: configQuery,\n    },\n    currentPattern.name,\n    `?pattern=${currentPattern.id}${\n      withConfig ? `&config=${encodeURIComponent(configQuery)}` : ''\n    }`\n  );\n}\n\nfunction setCurrentPattern(pattern, setPatternOptions) {\n  selectPattern(pattern, setPatternOptions);\n  history.pushState(\n    { pattern: pattern.id },\n    pattern.name,\n    '?pattern=' + pattern.id\n  );\n}\n\nfunction initSize() {\n  sizeControls.element.addEventListener('sizechange', ({ detail }) => {\n    setSize(detail);\n  });\n}\n\nfunction setSize({ width, height }) {\n  elements.canvas.removeAttribute('width');\n  elements.canvas.removeAttribute('height');\n\n  if (width && height) {\n    elements.canvas.style.width = `${width}px`;\n    elements.canvas.style.height = `${height}px`;\n    if (!elements.canvas.parentElement.classList.contains('overflow')) {\n      elements.canvas.parentElement.classList.add('overflow');\n    }\n  } else {\n    elements.canvas.parentElement.classList.remove('overflow');\n    elements.canvas.removeAttribute('style');\n  }\n\n  currentPattern.draw();\n}\n\nfunction initRouting() {\n  window.addEventListener('popstate', ({ state }) => {\n    updateState(state);\n  });\n}\n\nfunction updateState(state) {\n  const pattern = findPatternById(state.pattern);\n  selectPattern(pattern, {\n    draw: false,\n    config: state.config ? JSON.parse(state.config) : {},\n  });\n\n  currentPattern.draw();\n}\n\nfunction findPatternById(patternId) {\n  const pattern = patterns.find(({ id }) => id === patternId);\n  if (!pattern) {\n    throw new Error(`Pattern with id \"${patternId} not found!`);\n  }\n  return pattern;\n}\n\nfunction selectPattern(pattern, { config, draw = true } = {}) {\n  currentPattern = pattern;\n  if (config) {\n    currentPattern.config = config;\n  }\n  if (controls) {\n    controls.destroy();\n  }\n  controls = new EditorControls({ pattern, config });\n  controls.addEventListener('input', () => currentPattern.draw());\n  controls.addEventListener('change', onInputsChange);\n\n  if (pattern.link) {\n    elements.patternLink.setAttribute('href', pattern.link);\n    elements.patternLink.removeAttribute('hidden');\n  } else {\n    elements.patternLink.setAttribute('hidden', 'hidden');\n  }\n\n  if (draw) {\n    currentPattern.draw();\n  }\n  player.update(currentPattern, { draw: false });\n  thumbnails.setCurrentPattern(pattern);\n  document.title = `${pattern.name} - String Art Studio`;\n}\n","export default class Player {\n  constructor(parentEl) {\n    this.elements = {\n      player: parentEl,\n      step: parentEl.querySelector('#step'),\n      //stepInstructions: parentEl.querySelector('#step_instructions'),\n      playerPosition: parentEl.querySelector('#player_position'),\n      playBtn: parentEl.querySelector('#play_btn'),\n      pauseBtn: parentEl.querySelector('#pause_btn'),\n      text: parentEl.querySelector('#player_text'),\n    };\n    this.stepCount = 0;\n    this._isPlaying = false;\n\n    this.elements.playerPosition.addEventListener('input', ({ target }) => {\n      this.goto(+target.value);\n    });\n\n    this.elements.playBtn.addEventListener('click', () => {\n      this.play();\n    });\n\n    this.elements.pauseBtn.addEventListener('click', () => {\n      this.pause();\n    });\n  }\n\n  updateStatus(isPlaying) {\n    if (this._isPlaying !== isPlaying) {\n      this.elements.player.classList.toggle('playing');\n      this._isPlaying = isPlaying;\n    }\n  }\n\n  update(stringArt, { draw = true } = {}) {\n    this.stringArt = stringArt;\n    this.stepCount = stringArt.getStepCount();\n    this.elements.playerPosition.setAttribute('max', this.stepCount);\n    this.elements.step.innerText = `${this.stepCount}/${this.stepCount}`;\n    this.elements.text.style.removeProperty('width');\n    this.elements.text.style.width =\n      (this.elements.text.clientWidth || 70) + 'px';\n    this.goto(this.stepCount, { updateStringArt: draw });\n  }\n\n  updatePosition(position) {\n    this.elements.step.innerText = `${position}/${this.stepCount}`;\n    this.elements.playerPosition.value = position;\n  }\n\n  goto(position, { updateStringArt = true } = {}) {\n    this.pause();\n    this.updatePosition(position);\n    if (updateStringArt) {\n      this.stringArt.goto(position);\n    }\n  }\n\n  setInstructions(instructions) {\n    // this.elements.stepInstructions.innerText = instructions;\n  }\n\n  play() {\n    this.updateStatus(true);\n    cancelAnimationFrame(this.renderRafId);\n\n    if (this.stringArt.position === this.stepCount) {\n      this.stringArt.goto(0);\n    }\n\n    const self = this;\n\n    step();\n\n    function step() {\n      if (!self.stringArt.drawNext().done) {\n        self.renderRafId = requestAnimationFrame(step);\n      } else {\n        self.updateStatus(false);\n      }\n      self.updatePosition(self.stringArt.position);\n    }\n  }\n\n  pause() {\n    cancelAnimationFrame(this.renderRafId);\n    this.updateStatus(false);\n  }\n\n  toggle() {\n    if (this._isPlaying) {\n      this.pause();\n    } else {\n      this.play();\n    }\n  }\n}\n","import patternTypes from '../pattern_types.js';\n\nconst THUMBNAIL_WIDTH = 100;\nconst MINIMIZED_CLASS = 'minimized';\n\nexport class Thumbnails {\n  elements = {\n    root: document.querySelector('#pattern_select_panel'),\n    thumbnails: document.querySelector('#pattern_select_thumbnails'),\n    toggleBtn: document.querySelector('#pattern_select_btn'),\n    dropdown: document.querySelector('#pattern_select_dropdown'),\n  };\n\n  constructor() {\n    this.elements.toggleBtn.addEventListener('click', () => this.toggle());\n  }\n\n  toggle() {\n    if (this.elements.root.classList.contains(MINIMIZED_CLASS)) {\n      this.elements.root.classList.remove(MINIMIZED_CLASS);\n      if (!this.thumbnailsRendered) {\n        this.createThumbnails();\n        this.thumbnailsRendered = true;\n      }\n\n      this._onClickOutside = e => {\n        if (!e.target.closest('#pattern_select_panel')) {\n          this.toggle();\n        }\n      };\n\n      document.body.addEventListener('mousedown', this._onClickOutside);\n    } else {\n      this.elements.root.classList.add(MINIMIZED_CLASS);\n      document.body.removeEventListener('mousedown', this._onClickOutside);\n      this._onClickOutside = null;\n    }\n  }\n\n  setCurrentPattern(pattern) {\n    this.pattern = pattern;\n    this.elements.toggleBtn.innerText = pattern.name;\n  }\n\n  createThumbnails() {\n    const thumbnailsFragment = document.createDocumentFragment();\n    const patterns = [];\n\n    patternTypes.forEach(PatternType => {\n      const canvas = document.createElement('canvas');\n      canvas.style.width = canvas.style.height = `${THUMBNAIL_WIDTH}px`;\n\n      const pattern = new PatternType(canvas);\n      pattern.config = Object.assign(\n        {\n          margin: 1,\n          enableBackground: false,\n          nailRadius: 0.5,\n        },\n        PatternType.thumbnailConfig\n      );\n\n      patterns.push(pattern);\n\n      const li = document.createElement('li');\n      thumbnailsFragment.appendChild(li);\n      const patternLink = document.createElement('a');\n      patternLink.href = `?pattern=${pattern.id}`;\n      patternLink.setAttribute('data-pattern', pattern.id);\n      patternLink.title = pattern.name;\n      patternLink.appendChild(canvas);\n      li.appendChild(patternLink);\n    });\n\n    this.elements.thumbnails.appendChild(thumbnailsFragment);\n    patterns.forEach(pattern => pattern.draw());\n\n    this.elements.thumbnails.addEventListener('click', e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const link = e.target.closest('[data-pattern]');\n\n      if (!link) {\n        return false;\n      }\n\n      this.elements.root.dispatchEvent(\n        new CustomEvent('change', {\n          detail: { pattern: link.dataset.pattern },\n        })\n      );\n      this.toggle();\n    });\n  }\n\n  addOnChangeListener(listener) {\n    this.elements.root.addEventListener('change', listener);\n  }\n\n  removeOnChangeListener(listener) {\n    this.elements.root.removeEventListener('change', listener);\n  }\n}\n"],"names":["$e8c1397eac31f13e$var$COLOR_CONTROLS","key","label","defaultValue","type","show","isMultiColor","attr","min","max","step","children","multicolorByLightness","config","this","multicolorRange","colorCount","minLightness","maxLightness","multicolorStart","darkMode","saturation","reverseColors","multiColorStep","multiColorLightnessStep","colors","Array","fill","map","_","colorIndex","lightness","reverse","getColor","color","getColorMap","stepCount","Error","stepsPerColor","Math","floor","colorMap","Map","i","set","include","exclude","defaults","controls","getControls","controlsConfig","filter","includes","control","finalControl","Object","freeze","$a8180031c78213da$var$PI2","PI","canvas","context","getContext","setConfig","centerX","width","nails","nailRadius","nailsColor","nailNumbersFontSize","addNail","nail","push","drawNumbers","globalCompositeOperation","beginPath","fillStyle","textBaseline","font","nailNumberOffset","forEach","point","x","y","number","moveTo","arc","isRightAlign","numberPosition","textAlign","fillText","String","$65e05ee91a8797e3$var$COLORS","$65e05ee91a8797e3$var$COMMON_CONFIG_CONTROLS","isDisabled","showNails","showStrings","displayValue","margin","showNailNumbers","enableBackground","customBackgroundColor","$65e05ee91a8797e3$var$flattenConfig","configControls","reduce","$65e05ee91a8797e3$export$2e2bcd8739ae039","ctx","dpr","window","devicePixelRatio","bsr","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","pixelRatio","concat","defaultConfig","_defaultConfig","_config","value","assign","getSize","clientWidth","clientHeight","v","setUpDraw","removeAttribute","height","size","setAttribute","center","$a8180031c78213da$export$2e2bcd8739ae039","clearRect","lineWidth","stringWidth","afterDraw","drawNails","initDraw","backgroundColor","fillRect","draw","position","Infinity","stringsIterator","generateStrings","drawNext","done","goto","result","next","getStepCount","name","$ff21866e88ed26dc$var$PI2","getPoint","index","points","has","get","realIndex","isReverse","n","sin","indexAngle","rotationAngle","radius","cos","serializedConfig","_serializeConfig","rotation","configCenter","props","clear","join","nailsNumberStart","getNumber","round","$828d2af56886c091$var$COLOR_CONFIG","$e8c1397eac31f13e$export$2e2bcd8739ae039","getConfig","id","link","$ff21866e88ed26dc$export$2e2bcd8739ae039","nailsConfig","innerLength","rotationConfig","super","layers","layersCount","circleConfig","circle","shift","repetition","currentInnerLength","repetitionCount","strokeStyle","prevPointIndex","prevPoint","isPrevPoint","stepColor","nextPointIndex","lineTo","stroke","drawSpiral","$17fe1039ca333e84$export$2e2bcd8739ae039","nSpirals","radiusIncrease","angleStep","PI2","spiralRotations","maxRadius","nailsPerSpiral","angleIncrease","s","nailNumber","spiralIndex","centerx","centery","angle","generatePoints","lastPoint","$f11ad0f2a18da5c9$var$SIDES","$f11ad0f2a18da5c9$var$SIDES_ORDER","$f11ad0f2a18da5c9$var$SIDES_ROTATION","left","bottom","right","top","$f11ad0f2a18da5c9$export$2e2bcd8739ae039","maxSize","nailSpacing","layerAngle","layerIndex","_getLayerProps","layerStart","theta","pivot","cosAngle","sinAngle","side","layerStringCount","sideIndex","indexOf","nextSide","length","nextSideRotation","sideProps","_getLayerColors","layerSize","pow","color1","color2","colorPerLayer","layerColor","drawSide","layer","drawLayer","count","sideOrder","$6489b1167eb82c4c$var$PI2","configSize","sides","sideCount","sideAngle","radiusAngle","_getProps","fitSize","boundingRect","getBoundingRect","scale","overrideConfig","nailsSpacing","sideSize","nailsDistance","nailsPerSide","getSidePoint","pointsMapIndex","startX","start","getCenterPoint","firstPoint","slice","drawCenter","drawSides","sideIndexStart","index1","radiusNailsCount","$d89aefe1e0b94ba8$var$COLOR_CONFIG","$a3a02ffca86b5e03$var$COLOR_CONFIG","$8b13425f1e264518$export$2e2bcd8739ae039","_n","extraNails","sideNails","starCenterStart","circlePointsStart","sinSideAngle","cosSideAngle","circlePointsEnd","getStarPoint","centerY","reverseOrder","prevSide","innerColor","generateStarPoints","prevSideIndex","outterColor","prevCirclePoint","isPrevSide","nextPoint","drawCircle","drawStar","size1","show1","end1","size2","show2","end2","size3","show3","getSetUp","lineSpacing","lineNailCount","firstCirclePoint","totalNailCount","totalIndexCount","getLayer","call","enable","endIndex","indexLength","circleIndex","self","advance","getPointIndex","layerShift","steps","time","base","stepsToRender","toIndex","instructions","drawTimesTable","$828d2af56886c091$export$2e2bcd8739ae039","layerSpread","minNailDistance","maxShapeNailsCount","prop","circumsference","circleNails","nextLayerIndex","polygonConfig","polygon","$6489b1167eb82c4c$export$2e2bcd8739ae039","bezier","limitedBezier","ceil","layerAngleShift","polygons","leftSide","centerIndexes","getCenterIndexes","extraNailCount","$2fc16ffa17719734$var$elements","document","querySelector","controlsPanel","sidebarForm","$2fc16ffa17719734$var$EVENTS","Set","$2fc16ffa17719734$var$inputTimeout","pattern","state","_getState","groups","eventHandlers","input","change","_toggleFieldset","e","target","nodeName","parentElement","classList","toggle","groupId","dataset","group","contains","_updateState","_toggleFieldSetOnEnter","_wrappedOnInput","_onInput","addEventListener","_wrappedOnTouchStart","_onTouchStart","controlElements","renderControls","destroy","removeEventListener","innerHTML","event","eventHandler","Function","add","_triggerEvent","eventData","getAttribute","_postponeRangeInput","currentInputRange","currentInputRangeValue","_rangeLockTimeout","setTimeout","_wrappedOnTouchEnd","_onTouchEnd","body","_wrappedOnRangeScroll","_onRangeScroll","_lockRange","clearTimeout","_postponeRangeInputTimeout","preventDefault","updateInput","inputElement","originalEvent","deferChange","inputValue","parseFloat","checked","$2fc16ffa17719734$var$getInputValue","controlKey","replace","formattedValue","innerText","triggerChange","updateControlsVisibility","localStorage","getItem","JSON","parse","newState","setItem","stringify","removeItem","shouldShowControl","controlEl","shouldDisableControl","inputEl","updateInputs","entries","valueEl","containerEl","_configControls","controlsFragment","createDocumentFragment","controlId","createElement","groupTitleEl","appendChild","className","childrenContainer","realValue","inputValueEl","updateGroupsState","requestAnimationFrame","querySelectorAll","groupEl","groupState","remove","$0597ff46967fdd49$var$sizeControls","$0597ff46967fdd49$var$elements","sizeSelect","sizeCustom","orientationSelect","$0597ff46967fdd49$var$cmToPixels","cm","dpi","$0597ff46967fdd49$var$SCREEN_SIZE","screen","$0597ff46967fdd49$var$SIZES","$52852adbc3c0b381$var$elements","patternLink","downloadBtn","downloadNailsBtn","resetBtn","buttons","$52852adbc3c0b381$var$patterns","Pattern","$52852adbc3c0b381$var$currentPattern","$52852adbc3c0b381$var$player","parentEl","elements","player","playerPosition","playBtn","pauseBtn","text","_isPlaying","play","pause","updateStatus","isPlaying","update","stringArt","style","removeProperty","updateStringArt","updatePosition","setInstructions","cancelAnimationFrame","renderRafId","$52852adbc3c0b381$var$sizeControls","element","getCurrentSize","sizeOptionsFragment","sizeListItem","selectedSize","selectedSizeId","find","_notifyOnChange","getValue","select","parseInt","dispatchEvent","CustomEvent","detail","from","$52852adbc3c0b381$var$thumbnails","root","thumbnails","toggleBtn","dropdown","thumbnailsRendered","createThumbnails","_onClickOutside","closest","setCurrentPattern","thumbnailsFragment","patterns","PatternType","thumbnailConfig","li","href","title","stopPropagation","addOnChangeListener","listener","removeOnChangeListener","$52852adbc3c0b381$var$controls","$52852adbc3c0b381$var$downloadCanvas","downloadLink","download","toDataURL","click","$52852adbc3c0b381$var$downloadNailsImage","currentConfig","$52852adbc3c0b381$var$reset","confirm","$52852adbc3c0b381$var$setCurrentPattern","$52852adbc3c0b381$var$onInputsChange","withConfig","configQuery","history","replaceState","encodeURIComponent","setPatternOptions","$52852adbc3c0b381$var$selectPattern","pushState","$52852adbc3c0b381$var$updateState","$52852adbc3c0b381$var$findPatternById","patternId","$2fc16ffa17719734$export$2e2bcd8739ae039","$52852adbc3c0b381$var$initRouting","$52852adbc3c0b381$var$setSize","$52852adbc3c0b381$var$initSize","queryParams","URLSearchParams","location","search","queryPattern","dialogId","toggleFor"],"version":3,"file":"index.cf5e5f10.js.map"}