{"mappings":"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","sources":["src/scripts/Nails.js","src/scripts/StringArt.js","src/scripts/string_art_types/Spirals.js","src/scripts/string_art_types/Circle.js","src/scripts/string_art_types/Eye.js","src/scripts/pattern_types.js","src/scripts/string_art_types/Star.js","src/scripts/string_art_types/Assymetry.js","src/scripts/string_art_types/TimesTables.js","src/scripts/string_art_types/Spiral.js","src/scripts/string_art_types/Circles.js","src/scripts/editor/EditorControls.js","src/scripts/editor/EditorSizeControls.js","src/scripts/main.js","src/scripts/editor/Player.js"],"sourcesContent":["const PI2 = Math.PI * 2;\nconst NUMBER_MARGIN = 4;\n\nexport default class Nails {\n    constructor(canvas, config) {\n        this.context = canvas.getContext(\"2d\");\n        this.setConfig(config);\n        this.centerX = canvas.width / 2;\n        this.nails = [];\n    }\n\n    setConfig({ nailRadius, nailsColor, nailNumbersFontSize}) {\n        this.nailRadius = nailRadius;\n        this.nailsColor = nailsColor;\n        this.nailNumbersFontSize = nailNumbersFontSize;\n        this.nails = [];\n    }\n\n    // Adds a nail to be rendered. nail: { point, number }\n    addNail(nail) {\n        this.nails.push(nail);\n    }\n\n    fill({ drawNumbers = true} = {}) {\n        this.context.globalCompositeOperation = \"source-over\";\n        this.context.beginPath();\n        this.context.fillStyle = this.nailsColor;\n        this.context.textBaseline = \"middle\";\n        this.context.font = `${this.nailNumbersFontSize}px sans-serif`;\n        const nailNumberOffset = this.nailRadius + NUMBER_MARGIN;\n\n        this.nails.forEach(({ point: [x, y], number }) => {\n            this.context.moveTo(x + this.nailRadius, y);\n            this.context.arc(x, y, this.nailRadius, 0, PI2)\n            if (drawNumbers && number !== undefined && number !== null) {\n                const isRightAlign = x < this.centerX;\n\n                const numberPosition = [\n                    isRightAlign ? x - nailNumberOffset : x + nailNumberOffset,\n                    y\n                ];\n\n                this.context.textAlign = isRightAlign ? \"right\" : \"left\";\n                this.context.fillText(String(number), ...numberPosition);\n            }\n        });\n\n        this.context.fill();\n        this.nails = [];\n    }\n}","import Nails from \"./Nails.js\";\n\nconst COLORS = {\n    dark: \"#171717\",\n    light: \"#ffffff\"\n};\n\nconst COMMON_CONFIG_CONTROLS = [\n    {\n        key: 'general',\n        label: 'General',\n        type: 'group',\n        defaultValue: 'minimized',\n        children: [\n            {\n                key: 'showStrings',\n                label: 'Show strings',\n                defaultValue: true,\n                type: \"checkbox\",\n                isDisabled: ({showNails}) => !showNails\n            },\n            {\n                key: 'stringWidth',\n                label: 'String width',\n                defaultValue: 1,\n                type: \"range\",\n                attr: {\n                    min: 0.2,\n                    max: 4,\n                    step: 0.2\n                },\n                show: ({showStrings}) => showStrings\n            },\n            {\n                key: 'margin',\n                label: 'Margin',\n                defaultValue: 20,\n                type: \"number\",\n                attr: {\n                    min: 0,\n                    max: 500,\n                    step: 1\n                },\n                displayValue: ({margin}) => `${margin}px`\n            }\n        ]\n    },\n    {\n        key: 'nails',\n        label: 'Nails',\n        type: 'group',\n        defaultValue: 'minimized',\n        children: [\n            {\n                key: 'showNails',\n                label: 'Show nails',\n                defaultValue: true,\n                type: \"checkbox\",\n                isDisabled: ({showStrings}) => !showStrings\n            },\n            {\n                key: 'nailRadius',\n                label: 'Nail size',\n                defaultValue: 1.5,\n                type: \"range\",\n                attr: {\n                    min: 0.5,\n                    max: 5,\n                    step: 0.25\n                },\n                show: ({showNails}) => showNails\n            },\n            {\n                key: 'nailsColor',\n                label: 'Nails color',\n                defaultValue: \"#ffffff\",\n                type: \"color\",\n            },\n            {\n                key: 'showNailNumbers',\n                label: 'Show nail numbers',\n                defaultValue: false,\n                type: \"checkbox\",\n                show: ({showNails}) => showNails\n            },\n            {\n                key: 'nailNumbersFontSize',\n                label: 'Nail numbers font size',\n                defaultValue: 10,\n                type: \"range\",\n                attr: {\n                    min: 6,\n                    max: 24,\n                    step: 0.5\n                },\n                displayValue: ({nailNumbersFontSize}) => `${nailNumbersFontSize}px`,\n                show: ({showNails, showNailNumbers}) => showNails && showNailNumbers\n            },\n        ]\n    },\n    {\n        key: 'background',\n        label: 'Background',\n        type: 'group',\n        defaultValue: 'minimized',\n        children: [\n            {\n                key: 'darkMode',\n                label: 'Dark mode',\n                defaultValue: true,\n                type: 'checkbox'\n            },\n            {\n                key: 'customBackgroundColor',\n                label: 'Custom background color',\n                defaultValue: false,\n                type: 'checkbox',\n            },\n            {\n                key: 'backgroundColor',\n                label: 'Background color',\n                defaultValue: COLORS.dark,\n                type: 'color',\n                show: ({customBackgroundColor}) => customBackgroundColor\n            },\n        ]\n    }\n];\n\nclass StringArt {\n    constructor(canvas) {\n        if (!canvas) {\n            throw new Error(\"Canvas not specified!\");\n        }\n\n        this.canvas = canvas;\n        this.ctx = this.canvas.getContext(\"2d\");\n        const dpr = window.devicePixelRatio || 1;\n        const bsr = this.ctx.webkitBackingStorePixelRatio ||\n            this.ctx.mozBackingStorePixelRatio ||\n            this.ctx.msBackingStorePixelRatio ||\n            this.ctx.oBackingStorePixelRatio ||\n            this.ctx.backingStorePixelRatio || 1;\n        this.pixelRatio = dpr / bsr;\n    }\n\n    get configControls() {\n        return (this.controls ?? []).concat(COMMON_CONFIG_CONTROLS);\n    }\n\n    get defaultConfig() {\n        if (!this._defaultConfig) {\n            this._defaultConfig = flattenConfig(this.configControls);\n        }\n\n        return this._defaultConfig;\n    }\n\n    get config() {\n        return this._config ?? this.defaultConfig;\n    }\n\n    set config(value) {\n        this._config = Object.assign({}, this.defaultConfig, value);\n    }\n\n    getSize() {\n        const canvasScreenSize = [this.canvas.clientWidth, this.canvas.clientHeight];\n        return canvasScreenSize.map(v => v * this.pixelRatio);\n    }\n\n    setUpDraw() {\n        this.canvas.removeAttribute('width');\n        this.canvas.removeAttribute('height');\n        const [width, height] = this.size = this.getSize();\n        Object.assign(this, this.size);\n        this.canvas.setAttribute('width', width);\n        this.canvas.setAttribute('height', height);\n        this.center = this.size.map(value => value / 2);\n\n        if (this.nails) {\n            this.nails.setConfig(this.config);\n        } else {\n            this.nails = new Nails(this.canvas, this.config);\n        }\n\n        this.ctx.clearRect(0, 0, ...this.size);\n        this.ctx.lineWidth = this.config.stringWidth;\n    }\n\n    afterDraw() {\n        const {showNails, showNailNumbers} = this.config;\n        if (showNails) {\n            this.drawNails();\n            this.nails.fill({ drawNumbers: showNailNumbers });\n        }\n    }\n\n    initDraw() {\n        this.setUpDraw(this.config);\n        const { showNails, showNailNumbers, darkMode, backgroundColor, customBackgroundColor } = this.config;\n\n        this.ctx.beginPath();\n        this.ctx.globalCompositeOperation = 'destination-over';\n        this.ctx.fillStyle = customBackgroundColor ? backgroundColor : darkMode ? COLORS.dark : COLORS.light;\n        this.ctx.fillRect(0, 0, ...this.size);\n\n        this.ctx.globalCompositeOperation = 'source-over';\n        if (showNails) {\n            this.drawNails();\n            this.nails.fill({ drawNumbers: showNailNumbers });\n        }\n    }\n\n    /**\n     * Draws the string art on canvas\n     * @param { step: number } renderConfig configuration for rendering. Accepts the step to render (leave undefined or null to render all)\n     */\n    draw({position = Infinity} = {}) {\n        this.initDraw();\n        const { showStrings } = this.config;\n\n        if (showStrings) {\n            this.stringsIterator = this.generateStrings();\n            this.position = 0;\n\n            while(!this.drawNext().done && this.position < position);\n            this.afterDraw();\n        }\n    }\n\n    goto(position) {\n        if (position === this.position) {\n            return;\n        }\n\n        if (this.stringsIterator && position > this.position) {\n            while(!this.drawNext().done && this.position < position);\n        } else {\n            this.draw({ position });\n        }\n    }\n\n    drawNext() {\n        const result = this.stringsIterator.next();\n\n        if (result.done) {\n            this.afterDraw();\n        }\n        else {\n            this.position++;\n        }\n\n        return result;\n    }\n\n    generateStrings() {\n        throw new Error(\"generateStrings method not defined!\");\n    }\n\n    getStepCount() {\n        throw new Error(`'getStepCount' method not implemented for string art type \"${this.name}\"`);\n    }\n}\n\nfunction flattenConfig(configControls) {\n    return configControls.reduce((config, {key, defaultValue, children}) =>\n        children ? {\n            ...config,\n            ...flattenConfig(children)\n        } : {\n            ...config,\n            [key]: defaultValue\n        },\n    {});\n}\n\nexport default StringArt;\n","import StringArt from \"../StringArt.js\";\n\nclass Spirals extends StringArt{\n    name = \"Spirals\";\n    id = \"spirals\";\n    link = \"https://www.etsy.com/il-en/listing/974865185/3d-string-art-spiral-mandala-wall?ref=shop_home_active_10&frs=1\";\n    controls = [\n        {\n            key: 'n',\n            label: 'Number of nails',\n            defaultValue: 92,\n            type: \"range\",\n            attr: {\n                min: 3,\n                max: 200,\n                step: 1\n            }\n        },\n        {\n            key: 'radiusIncrease',\n            label: 'Size',\n            defaultValue: 3,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 20,\n                step: 0.2\n            }\n        },\n        {\n            key: 'angleStep',\n            label: 'Angle step',\n            defaultValue: 0.05,\n            type: \"range\",\n            attr: {\n                min: 0.01,\n                max: 1,\n                step: 0.01,\n            }\n        },\n        {\n            key: 'nSpirals',\n            label: 'Number of spirals',\n            defaultValue: 3,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 20,\n                step: 1\n            }\n        },\n        {\n            key: 'color',\n            label: 'String color',\n            defaultValue: \"#00ddff\",\n            type: \"color\",\n        }\n    ];\n    \n    *generatePoints() {\n        const {\n            n, radiusIncrease, angleStep, nSpirals,\n        } = this.config;\n        \n        let currentRadius = 0;\n        let angle = 0;\n        const [centerx, centery] = this.center;\n\n        for (let i = 0; i < n; i++) {\n            for (let s = 0; s < nSpirals; s++) {\n                const rotation = s * 2 * Math.PI / nSpirals;\n                const point = [\n                    centerx + currentRadius * Math.sin(angle + rotation),\n                    centery + currentRadius * Math.cos(angle + rotation)\n                ];\n                yield {point, nailNumber: `${s + 1}_${i + 1}`};\n            }\n            \n            angle += angleStep;\n            currentRadius += radiusIncrease;\n        }\n    }\n\n    *generateStrings() {\n        const points = this.generatePoints();\n        let index = 0;\n        this.ctx.beginPath();\n        this.ctx.moveTo(...this.center);\n        this.ctx.strokeStyle = this.config.color;\n\n        let lastPoint = this.center;\n\n        for (const {point} of points) {\n            this.ctx.beginPath();\n            this.ctx.moveTo(...lastPoint);\n            lastPoint = point;\n            this.ctx.lineTo(...point);\n            this.ctx.strokeStyle = this.config.color;\n            this.ctx.stroke();\n            yield index++;\n        }\n    }\n\n    getStepCount() {\n        const { n, nSpirals } = this.config;\n        return n * nSpirals;\n    }\n\n    drawNails() {\n        const points = this.generatePoints();\n        for (const {point, nailNumber} of points) {\n            this.nails.addNail({point, number: nailNumber});\n        }\n    }\n}\n\nexport default Spirals;","const PI2 = Math.PI * 2;\n\nexport default class Circle {\n    constructor(config) {\n        const { n, size, margin = 0, rotation = 0, center, radius, reverse = false } = this.config = config;\n        \n        this.center = center ?? size.map(v => v / 2);\n        this.radius = radius ?? Math.min(...this.center) - margin;\n\n        this.indexAngle = PI2 / n;\n        this.rotationAngle = -PI2 * rotation;\n        this.isReverse = reverse;\n    }\n\n    getPoint(index = 0) {\n        const realIndex = this.isReverse ? this.config.n - 1 - index : index;\n\n        return [\n            this.center[0] + Math.sin(realIndex * this.indexAngle + this.rotationAngle) * this.radius,\n            this.center[1] + Math.cos(realIndex * this.indexAngle + this.rotationAngle) * this.radius\n        ];\n    }\n\n    drawNails(nails, {nailsNumberStart = 0, getNumber} = {}) {\n        for (let i=0; i < this.config.n; i++) {\n            nails.addNail({point: this.getPoint(i), number: getNumber ? getNumber(i) : i + 1 + nailsNumberStart});\n        }\n    }\n\n    static rotationConfig = {\n        key: 'rotation',\n        label: 'Rotation',\n        defaultValue: 0,\n        type: \"range\",\n        attr: {\n            min: 0,\n            max: 1 + 1/360,\n            step: 1 / 360,\n        },\n        displayValue: (config, { key }) => `${Math.round(config[key] * 360)}`\n    };\n}","import StringArt from \"../StringArt.js\";\n\nconst MARGIN = 20;\nconst SIDES = ['left', 'bottom', 'right', 'top'];\nconst SIDES_ORDER = ['left', 'bottom', 'right', 'top'];\n\nconst SIDES_ROTATION = {\n    left: 0,\n    bottom: Math.PI / 2,\n    right: Math.PI,\n    top: Math.PI * 1.5\n};\n\nclass Eye extends StringArt{\n    name = \"Eye\"\n    id = \"eye\"\n    link = \"https://www.etsy.com/listing/489853161/rose-of-space-string-art-sacred-geometry?ga_order=most_relevant&ga_search_type=all&ga_view_type=gallery&ga_search_query=string+art&ref=sr_gallery_1&epik=dj0yJnU9WXNpM1BDTnNkLVBtcWdCa3AxN1J5QUZRY1FlbkJ5Z18mcD0wJm49ZXdJb2JXZmVpNVVwN1NKQ3lXMy10ZyZ0PUFBQUFBR0ZuUzZv\";\n    controls = [\n        {\n            key: 'n',\n            label: 'Number of nails per side',\n            defaultValue: 82,\n            type: \"range\",\n            attr: {\n                min: 2,\n                max: 200,\n                step: 1\n            }\n        },\n        {\n            key: 'layers',\n            label: 'Layers',\n            defaultValue: 13,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 20,\n                step: 1\n            }\n        },\n        {\n            key: 'angle',\n            label: 'Layer angle',\n            defaultValue: 30,\n            displayValue: ({angle}) => `${angle}`,\n            type: \"range\",\n            attr: {\n                min: 0,\n                max: 45,\n                step: 1\n            }\n        },\n        {\n            key: 'color',\n            label: 'Color',\n            type: 'group',\n            children: [\n                {\n                    key: 'color1',\n                    label: 'String #1 color',\n                    defaultValue: \"#11e8bd\",\n                    type: \"color\",\n                },\n                {\n                    key: 'color2',\n                    label: 'String #2 color',\n                    defaultValue: \"#6fff52\",\n                    type: \"color\",\n                },\n                {\n                    key: 'colorPerLayer',\n                    label: 'Color per layer',\n                    defaultValue: false,\n                    type: 'checkbox'\n                },\n            ]\n        }\n    ];\n\n    setUpDraw() {\n        super.setUpDraw();\n\n        const { n, angle } = this.config;\n\n        this.maxSize = Math.min(...this.size) - 2 * MARGIN;\n        this.nailSpacing = this.maxSize / (n - 1);\n        this.layerAngle = angle * Math.PI / 180;\n    }\n\n    // Sides: top, right, bottom, left\n    getPoint({index, angle, layerStart, rotation}) {\n        const theta = angle + rotation;\n\n        const point = { \n            x: layerStart.x, \n            y: layerStart.y + this.nailSpacing * index\n        };\n\n        const pivot = { x: this.center[0], y: this.center[1] };\n\n        const cosAngle = Math.cos(theta);\n        const sinAngle = Math.sin(theta);\n\n        const position = [\n            (cosAngle * (point.x - pivot.x) - sinAngle * (point.y - pivot.y) + pivot.x),\n            (sinAngle * (point.x - pivot.x) + cosAngle * (point.y - pivot.y) + pivot.y),\n        ];\n        return position;\n    }\n\n    *drawSide({ side, color = '#ffffff', angle, size, layerStart, layerStringCount }) {\n        const sideIndex = SIDES.indexOf(side);\n        const nextSide = SIDES[sideIndex === SIDES.length - 1 ? 0 : sideIndex + 1];\n        const rotation = SIDES_ROTATION[side];\n        const nextSideRotation = SIDES_ROTATION[nextSide];\n        \n        const sideProps = { layerStringCount, size, layerStart, angle };\n        \n        for(let i=0; i <= layerStringCount; i++) {\n            this.ctx.beginPath();\n            this.ctx.moveTo(...this.getPoint({ side, index: i, rotation, ...sideProps}));\n            this.ctx.lineTo(...this.getPoint({side: nextSide, index: i, rotation: nextSideRotation, ...sideProps}));\n            this.ctx.strokeStyle = color;\n            this.ctx.stroke();\n            yield i;\n        }\n    }\n\n    _getLayerProps(layerIndex) {\n        const colors = this._getLayerColors(layerIndex);\n        const layerAngle = this.layerAngle * layerIndex;\n        const layerSize = this.maxSize / Math.pow(Math.cos(this.layerAngle) + Math.sin(this.layerAngle), layerIndex);\n        const layerStart = { \n            x: this.center[0] - layerSize / 2, \n            y: this.center[1] - layerSize / 2\n        };\n        const layerStringCount = Math.floor(layerSize / this.nailSpacing);\n\n        return {\n            colors, layerAngle, layerSize, layerStart, layerStringCount\n        };\n    }\n\n    _getLayerColors(layerIndex) {\n        const { color1, color2, colorPerLayer } = this.config;\n        if (colorPerLayer) {\n            const layerColor = layerIndex % 2 ? color1 : color2;\n            return [layerColor, layerColor, layerColor, layerColor];\n        }\n        else {\n            return [color2, color1, color2, color1];\n        }\n    }\n\n    *drawLayer(layerIndex) {\n        const {\n            colors, layerAngle, layerSize, layerStart, layerStringCount\n        } = this._getLayerProps(layerIndex);\n\n        for (let i = 0; i < SIDES.length; i++) {\n            yield* this.drawSide({ \n                color: colors[i], \n                side: SIDES_ORDER[i],\n                angle: layerAngle,\n                size: layerSize,\n                layerStart,\n                layerStringCount\n            });\n        }\n    }\n\n    *generateStrings() {\n        const {layers} =  this.config;\n        for(let layer = layers - 1; layer >= 0; layer--) {\n            yield* this.drawLayer(layer);\n        }\n    }\n\n    getStepCount() {\n        let count = 0;\n        const {layers, angle, n} = this.config;\n        const layerAngle = angle * Math.PI / 180;\n        const maxSize = Math.min(this.canvas.clientWidth, this.canvas.clientHeight) - 2 * MARGIN;\n        const nailSpacing = maxSize / (n - 1);\n\n        for(let layer = 0; layer < layers; layer++) {\n            const layerSize = maxSize / Math.pow(Math.cos(layerAngle) + Math.sin(layerAngle), layer);\n            count += 4 * (Math.floor(layerSize / nailSpacing) + 1)\n        }\n\n        return count;\n    }\n\n    drawNails() {\n        const {layers} =  this.config;\n        for(let layer = layers - 1; layer >= 0; layer--) {\n            const {\n                layerAngle: angle, layerSize: size, layerStart, layerStringCount\n            } = this._getLayerProps(layer);\n\n            for (let s = 0; s < SIDES.length; s++) {\n                const sideOrder = SIDES_ORDER[s];\n                const rotation = SIDES_ROTATION[sideOrder];\n\n                for(let i=0; i <= layerStringCount; i++) {\n                    const sideProps = { layerStringCount, size, layerStart, angle };\n                    this.nails.addNail({\n                        point: this.getPoint({ sideOrder, index: i, rotation, ...sideProps}),\n                        number: `${layer + 1}_${s + 1}_${i + 1}`\n                    });\n                }\n            }\n        }\n    }\n}\n\nexport default Eye;","import Spirals from \"./string_art_types/Spirals.js\";\nimport Spiral from './string_art_types/Spiral.js';\nimport Eye from './string_art_types/Eye.js';\nimport TimesTables from './string_art_types/TimesTables.js';\nimport Star from \"./string_art_types/Star.js\";\nimport Assymetry from \"./string_art_types/Assymetry.js\";\nimport Circles from './string_art_types/Circles.js';\n\nconst patternTypes = [Star, Assymetry, TimesTables, Spirals, Spiral, Eye, Circles];\n\nexport default patternTypes;\n","import StringArt from \"../StringArt.js\";\nimport Circle from \"./Circle.js\";\n\nexport default class Star extends StringArt{\n    name = \"Star\";\n    id = \"star\";\n    link = \"https://www.etsy.com/listing/557818258/string-art-meditation-geometric-yoga?epik=dj0yJnU9Mm1hYmZKdks1eTc3bVY2TkVhS2p2Qlg0N2dyVWJxaTEmcD0wJm49MGlWSXE1SVJ2Vm0xZ0xtaGhITDBWQSZ0PUFBQUFBR0Zwd2lj\";\n    controls = [\n        {\n            key: 'sides',\n            label: 'Sides',\n            defaultValue: 3,\n            type: 'range',\n            attr: {\n                min: 3,\n                max: 20,\n                step: 1\n            }\n        },\n        {\n            key: 'sideNails',\n            label: 'Nails per side',\n            defaultValue: 40,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 200,\n                step: 1\n            }\n        },\n        Circle.rotationConfig,\n        {\n            key: 'colorGroup',\n            label: 'Color',\n            type: 'group',\n            children: [\n                {\n                    key: 'innerColor',\n                    label: 'Star color',\n                    defaultValue: \"#2ec0ff\",\n                    type: \"color\",\n                },\n                {\n                    key: 'outterColor',\n                    label: 'Outter color',\n                    defaultValue: \"#2a82c6\",\n                    type: \"color\",\n                },\n            ]\n        }\n    ];\n\n    get n() {\n        if (!this._n) {\n            const {n, sides} = this.config;\n            const extraNails = n % sides;\n            this._n = n - extraNails;\n        }\n\n        return this._n;\n    }\n\n    setUpDraw() {\n        this._n = null;\n        super.setUpDraw();\n\n        const { sides, rotation, sideNails, margin = 0 } = this.config;\n        this.circle = new Circle({\n            size: this.size,\n            n: sideNails * sides,\n            margin,\n            rotation,\n        });\n\n        this.sideAngle = Math.PI * 2 / sides;\n        this.nailSpacing = this.circle.radius / sideNails;\n        this.starCenterStart = (sideNails % 1) * this.nailSpacing;\n\n        this.sides = new Array(sides).fill(null).map((_, side) => {\n            const sideAngle = side * this.sideAngle + this.circle.rotationAngle;\n            const circlePointsStart = side * sideNails;\n\n            return {\n                sinSideAngle: Math.sin(sideAngle),\n                cosSideAngle: Math.cos(sideAngle),\n                circlePointsStart,\n                circlePointsEnd: circlePointsStart + sideNails\n            };\n        });\n    }\n\n    getStarPoint({ side, sideIndex }) {\n        const radius = this.starCenterStart + sideIndex * this.nailSpacing;\n        const {sinSideAngle, cosSideAngle} = this.sides[side];\n        const [centerX, centerY] = this.circle.center;\n\n        return [\n            centerX + sinSideAngle * radius,\n            centerY + cosSideAngle * radius\n        ];\n    }\n\n    *generateStarPoints({ reverseOrder  = false} = {}) {\n        const {sides, sideNails} = this.config;\n\n        for (let side = 0; side < sides; side++) {\n            const prevSide = side === 0 ? sides - 1 : side - 1;\n            for (let i=0; i < sideNails; i++) {\n                const sideIndex = reverseOrder ? sideNails - i : i;\n                yield { side, prevSide, sideIndex, point: this.getStarPoint({ side, sideIndex }) };\n            }\n        }\n    }\n\n    *drawStar() {\n        const {innerColor, sideNails} = this.config;\n\n        this.ctx.strokeStyle = innerColor;\n        let prevPoint;\n\n        for (const { prevSide, sideIndex, point} of this.generateStarPoints()) {\n            this.ctx.beginPath();\n\n            if (sideIndex && !(sideIndex % 2)) {\n                this.ctx.moveTo(...prevPoint);\n                this.ctx.lineTo(...point);\n            } else {\n                this.ctx.moveTo(...point);\n            }\n\n            const prevSideIndex = sideNails - sideIndex;\n            this.ctx.lineTo(...this.getStarPoint({ side: prevSide, sideIndex: prevSideIndex}))\n            prevPoint = point;\n            this.ctx.stroke();\n            yield;\n        }\n    }\n\n    *drawCircle() {\n        const {outterColor} = this.config;\n\n        let prevCirclePoint;\n        let isPrevSide = false;\n        this.ctx.strokeStyle = outterColor;\n        for (const { side, prevSide, sideIndex, point} of this.generateStarPoints({ reverseOrder: true })) {\n            this.ctx.beginPath();\n            if (!prevCirclePoint) {\n                prevCirclePoint = this.circle.getPoint(this.sides[prevSide].circlePointsStart);\n            }\n\n            this.ctx.moveTo(...prevCirclePoint);\n\n            this.ctx.lineTo(...point);\n            this.ctx.stroke();\n\n            yield;\n\n            this.ctx.beginPath();\n            this.ctx.moveTo(...point);\n            const nextPointIndex = isPrevSide\n                ? this.sides[prevSide].circlePointsEnd - sideIndex\n                : this.sides[side].circlePointsStart + sideIndex;\n\n            const nextPoint = this.circle.getPoint(nextPointIndex);\n            this.ctx.lineTo(...nextPoint);\n\n            prevCirclePoint = this.circle.getPoint(isPrevSide\n                ? this.sides[prevSide].circlePointsEnd - sideIndex + 1\n                : this.sides[side].circlePointsStart + sideIndex - 1);\n\n            this.ctx.lineTo(...prevCirclePoint);\n\n            this.ctx.stroke();\n            isPrevSide = !isPrevSide;\n            yield;\n        }\n    }\n\n    *generateStrings() {\n        yield* this.drawCircle();\n        yield* this.drawStar();\n    }\n\n    drawNails() {\n        this.circle.drawNails(this.nails);\n\n        for (const {point, side, sideIndex} of this.generateStarPoints()) {\n            this.nails.addNail({ point, number: sideIndex ? `${side + 1}_${sideIndex + 1}` : 0 });\n        }\n\n        this.circle.drawNails(this.nails);\n    }\n\n    getStepCount() {\n        const {sides, sideNails} = this.config;\n        const starCount = sideNails * sides;\n        return starCount * 3; // Once for each side + two more times for the side's circle\n    }\n}\n","import StringArt from \"../StringArt.js\";\nimport Circle from \"./Circle.js\";\n\nexport default class Assymetry extends StringArt{\n    name = \"Assymetry\";\n    id = \"assymetry\";\n    link = \"https://www.etsy.com/il-en/listing/1018950430/calming-wall-art-in-light-blue-for\";\n    controls = [\n        {\n            key: 'n',\n            label: 'Circle nails',\n            defaultValue: 144,\n            type: 'range',\n            attr: {\n                min: 3,\n                max: 300,\n                step: 1\n            }\n        },\n        Circle.rotationConfig,\n        {\n            key: 'layers',\n            label: 'Layers',\n            type: 'group',\n            children: [\n                {\n                    key: 'layer1',\n                    label: 'Layer 1',\n                    type: 'group',\n                    children: [\n                        {\n                            key: 'show1',\n                            label: 'Enable',\n                            defaultValue: true,\n                            type: 'checkbox'\n                        },\n                        {\n                            key: 'size1',\n                            label: 'Size',\n                            defaultValue: 0.25,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 0.5,\n                                step: ({config: {n}}) => 1 / n\n                            },\n                            displayValue: ({size1, n}) => Math.round(n * size1),\n                            show: ({show1}) => show1,\n                        },\n                        {\n                            key: 'end1',\n                            label: 'End Position',\n                            defaultValue: 1,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: ({config: {n}}) => 1 / n,\n                            },\n                            displayValue: ({end1, n}) => Math.round(n * end1),\n                            show: ({show1}) => show1,\n                        },\n                        {\n                            key: 'color1',\n                            label: 'Color',\n                            defaultValue: \"#a94fb0\",\n                            type: \"color\",\n                            show: ({show1}) => show1,\n                        },\n                        {\n                            key: 'reverse1',\n                            label: 'Reverse',\n                            defaultValue: false,\n                            type: 'checkbox',\n                            show: ({show1}) => show1\n                        },\n                    ]\n                },\n                {\n                    key: 'layer2',\n                    label: 'Layer 2',\n                    type: 'group',\n                    children: [\n                        {\n                            key: 'show2',\n                            label: 'Enable',\n                            defaultValue: true,\n                            type: 'checkbox'\n                        },\n                        {\n                            key: 'size2',\n                            label: 'Size',\n                            defaultValue: 0.125,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 0.5,\n                                step: ({config: {n}}) => 1 / n\n                            },\n                            displayValue: ({size2, n}) => Math.round(n * size2),\n                            show: ({show2}) => show2,\n                        },\n                        {\n                            key: 'end2',\n                            label: 'End Position',\n                            defaultValue: 0.888,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: ({config: {n}}) => 1 / n\n                            },\n                            displayValue: ({end2, n}) => Math.round(n * end2),\n                            show: ({show2}) => show2,\n                        },\n                        {\n                            key: 'color2',\n                            label: 'Color',\n                            defaultValue: \"#ec6ad0\",\n                            type: \"color\",\n                            show: ({show2}) => show2,\n                        },\n                        {\n                            key: 'reverse2',\n                            label: 'Reverse',\n                            defaultValue: false,\n                            type: 'checkbox',\n                            show: ({show2}) => show2\n                        },\n                    ]\n                },\n                {\n                    key: 'layer3',\n                    label: 'Layer 3',\n                    type: 'group',\n                    children: [\n                        {\n                            key: 'show3',\n                            label: 'Enable',\n                            defaultValue: true,\n                            type: 'checkbox'\n                        },\n                        {\n                            key: 'size3',\n                            label: 'Size',\n                            defaultValue: 0,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 0.5,\n                                step: ({config: {n}}) => 1 / n\n                            },\n                            displayValue: ({size3, n}) => Math.round(n * size3),\n                            show: ({show3}) => show3,\n                        },\n                        {\n                            key: 'end3',\n                            label: 'End Position',\n                            defaultValue: 0.826,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: ({config: {n}}) => 1 / n\n                            },\n                            displayValue: ({end2, n}) => Math.round(n * end2),\n                            show: ({show3}) => show3,\n                        },\n                        {\n                            key: 'color3',\n                            label: 'Color',\n                            defaultValue: \"#f08ad5\",\n                            type: \"color\",\n                            show: ({show3}) => show3,\n                        },\n                        {\n                            key: 'reverse3',\n                            label: 'Reverse',\n                            defaultValue: true,\n                            type: 'checkbox',\n                            show: ({show3}) => show3\n                        },\n                    ]\n                }\n            ]\n        },\n    ];\n\n    setUpDraw() {\n        super.setUpDraw();\n        Object.assign(this, this.getSetUp());\n    }\n\n    getSetUp() {\n        const { rotation, n, margin = 0 } = this.config;\n        const circle = new Circle({\n            size: this.getSize(),\n            n,\n            margin,\n            rotation: rotation - 0.25,\n        });\n\n        let lineSpacing = circle.indexAngle * circle.radius;\n        const lineNailCount = Math.floor(circle.radius / lineSpacing) - 1;\n        lineSpacing += (circle.radius - lineSpacing * lineNailCount) / lineNailCount;\n        const firstCirclePoint = circle.getPoint(0);\n        const totalNailCount = lineNailCount + n;\n        const totalIndexCount = totalNailCount + lineNailCount;\n        const layers = new Array(3).fill(null)\n            .map((_, i) => getLayer.call(this, i + 1))\n            .filter(({enable}) => enable)\n\n        return {\n            circle,\n            lineSpacing,\n            lineNailCount,\n            firstCirclePoint,\n            layers,\n            totalNailCount,\n            totalIndexCount,\n        };\n\n        function getLayer(layerIndex) {\n            const size = Math.round(n * this.config['size' + layerIndex]) + lineNailCount\n            return {\n                size,\n                endIndex: Math.round(this.config['end' + layerIndex] * (totalNailCount + lineNailCount)) - size,\n                color: this.config['color' + layerIndex],\n                enable: this.config['show' + layerIndex],\n                isReverse: this.config['reverse' + layerIndex],\n            };\n        }\n    }\n\n    /**\n     * Returns the position of a point on the line\n     * @param {index of the point in the circle, 0 is the center} index\n     */\n    getPoint(index) {\n        if (index < this.lineNailCount || index > this.totalNailCount) {\n            const linePosition = index < this.lineNailCount ? this.lineNailCount - index : index - this.totalNailCount;\n\n            const indexLength = (linePosition) * this.lineSpacing;\n            return [\n                this.firstCirclePoint[0] - indexLength * Math.sin(this.circle.rotationAngle),\n                this.firstCirclePoint[1] - indexLength * Math.cos(this.circle.rotationAngle)\n            ];\n        } else {\n            const circleIndex = index - this.lineNailCount;\n            return this.circle.getPoint(circleIndex);\n        }\n    }\n\n    *drawCircle({endIndex, color, isReverse, size}) {\n        let prevPoint;\n        let prevPointIndex;\n        let isPrevSide = false;\n        this.ctx.strokeStyle = color;\n        const self = this;\n        const advance = isReverse ? -1 : 1;\n\n        for(let index = 0; index <= endIndex; index++) {\n            this.ctx.beginPath();\n\n            if (prevPoint) {\n                this.ctx.moveTo(...prevPoint);\n                this.ctx.lineTo(...this.getPoint(prevPointIndex + advance));\n            } else {\n                this.ctx.moveTo(...this.getPoint(getPointIndex(index)));\n            }\n\n            prevPointIndex = getPointIndex(isPrevSide ? index : index + size);\n            prevPoint = this.getPoint(prevPointIndex);\n            this.ctx.lineTo(...prevPoint);\n            this.ctx.stroke();\n\n            yield;\n\n            isPrevSide = !isPrevSide;\n        }\n\n        function getPointIndex(index) {\n            return isReverse ? self.totalIndexCount - index : index;\n        }\n    }\n\n    *generateStrings() {\n        for (const layer of this.layers) {\n            yield* this.drawCircle(layer);\n        }\n    }\n\n    drawNails() {\n        this.circle.drawNails(this.nails, { nailsNumberStart: this.lineNailCount });\n\n        for (let i=0; i < this.lineNailCount; i++) {\n            this.nails.addNail({ point: this.getPoint(i), number: i + 1 });\n        }\n    }\n\n    getStepCount() {\n        const {layers} = this.getSetUp();\n        return layers.reduce((stepCount, layer) =>\n            stepCount + layer.endIndex + 1, 0\n        );\n    }\n}\n","import StringArt from \"../StringArt.js\";\nimport Circle from \"./Circle.js\";\n\nconst MARGIN = 20;\n\nexport default class TimesTables extends StringArt{\n    name = \"Times Tables\";\n    id = \"times_tables\";\n    link = \"https://www.youtube.com/watch?v=LWin7w9hF-E&ab_channel=Jorgedelatierra\";\n    controls = [\n        {\n            key: 'n',\n            label: 'Number of nails',\n            defaultValue: 180,\n            type: \"range\",\n            attr: {\n                min: 3,\n                max: 240,\n                step: 1\n            }\n        },\n        {\n            key: 'base',\n            label: 'Multiplication',\n            defaultValue: 2,\n            type: \"range\",\n            attr: {\n                min: 2,\n                max: 99,\n                step: 1\n            }\n        },\n        {\n            key: 'layers',\n            label: 'Layers',\n            defaultValue: 7,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 20,\n                step: 1\n            }\n        },\n        Circle.rotationConfig,\n        {\n            key: 'colorGroup',\n            label: 'Color',\n            type: 'group',\n            children: [\n                {\n                    key: 'multicolor',\n                    label: 'Use multiple colors',\n                    defaultValue: true,\n                    type: \"checkbox\",\n                },\n                {\n                    key: 'multicolorRange',\n                    label: 'Multicolor range',\n                    defaultValue: 180,\n                    type: \"range\",\n                    attr: {\n                        min: 1,\n                        max: 360,\n                        step: 1\n                    },\n                    show: ({multicolor}) => multicolor,\n                },\n                {\n                    key: 'multicolorStart',\n                    label: 'Multicolor start',\n                    defaultValue: 256,\n                    type: \"range\",\n                    attr: {\n                        min: 0,\n                        max: 360,\n                        step: 1\n                    },\n                    show: ({multicolor}) => multicolor,\n                },\n                {\n                    key: 'color',\n                    label: 'String color',\n                    defaultValue: \"#ff4d00\",\n                    type: \"color\",\n                    show: ({multicolor}) => !multicolor\n                },\n            ]\n        },\n    ];\n\n    get n() {\n        if (!this._n) {\n            const {n, layers} = this.config;\n            const extraNails = n % layers;\n            this._n = n - extraNails; // The number of nails should be a multiple of the layers, so the strings are exactly on the nails.\n        }\n\n        return this._n;\n    }\n\n    setUpDraw() {\n        this._n = null;\n        super.setUpDraw();\n\n        const {layers, multicolorRange, rotation} = this.config;\n        this.circle = new Circle({\n            size: this.size,\n            n: this.n,\n            margin: MARGIN,\n            rotation,\n        });\n        this.multiColorStep = multicolorRange / layers;\n        this.layerShift = Math.floor(this.n / layers);\n    }\n\n    *drawTimesTable({ shift = 0, color = \"#f00\", steps, time }) {\n        const {base} = this.config;\n        const n = this.n;\n        const stepsToRender = steps ?? n;\n\n        let point = this.circle.getPoint(shift);\n\n        for(let i=1; i <= stepsToRender; i++) {\n            this.ctx.beginPath();\n            this.ctx.moveTo(...point);\n            point = this.circle.getPoint(i + shift);\n            this.ctx.lineTo(...point);\n            const toIndex = (i * base) % n;\n            this.ctx.lineTo(...this.circle.getPoint(toIndex + shift));\n            this.ctx.strokeStyle = color;\n            this.ctx.stroke();\n            \n            yield { instructions: `${i - 1}  ${i}  ${toIndex}  ${i}`, index: time * n + i };\n        }\n    }\n\n    *generateStrings() {\n        const {color, multicolor, layers} = this.config;\n\n        for(let time = 0; time < layers; time++) {\n            const timeColor = multicolor ? this.getTimeColor(time, layers) : color;\n            yield* this.drawTimesTable({ \n                time,\n                color: timeColor, \n                shift: this.layerShift * time,\n            });\n        }\n    }\n\n    drawNails() {\n        this.circle.drawNails(this.nails);\n    }\n\n    getTimeColor(time) {\n        const {multicolorStart, darkMode} = this.config;\n\n        return `hsl(${multicolorStart + time * this.multiColorStep}, 80%, ${darkMode ? 50 : 40}%)`;\n    }\n\n    getStepCount() {\n        return this.config.layers * this.n;\n    }\n}\n            ","import StringArt from \"../StringArt.js\";\nimport Circle from \"./Circle.js\";\n\nexport default class Spiral extends StringArt{\n    id = \"spiral\";\n    name = \"Spiral\";\n    link = \"https://www.etsy.com/il-en/listing/943140543/personalized-gift-string-art-mandala?ref=sim_rv-5&pro=1\";\n    controls = [\n        {\n            key: 'n',\n            label: 'Number of nails',\n            defaultValue: 144,\n            type: \"range\",\n            attr: {\n                min: 3,\n                max: 200,\n                step: 1\n            }\n        },\n        {\n            key: 'repetition',\n            label: 'Repetition',\n            defaultValue: 2,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 60,\n                step: 1\n            }\n        },\n        {\n            key: 'innerLength',\n            label: 'Spiral thickness',\n            defaultValue: 72,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 144,\n                step: 1,\n            }\n        },\n        {\n            ...Circle.rotationConfig,\n            defaultValue: 0.49,\n        },\n        {\n            key: 'layers',\n            label: 'Layers',\n            defaultValue: 9,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 20,\n                step: 1\n            }\n        },\n        {\n            key: 'layerSpread',\n            label: 'Layer spread',\n            defaultValue: 13,\n            type: \"range\",\n            attr: {\n                min: 1,\n                max: 200,\n                step: 1\n            }\n        },\n        {\n            key: 'colorGroup',\n            label: 'Color',\n            type: 'group',\n            children: [\n                {\n                    key: 'multicolorRange',\n                    label: 'Multicolor range',\n                    defaultValue: 216,\n                    type: \"range\",\n                    attr: {\n                        min: 1,\n                        max: 360,\n                        step: 1\n                    },\n                },\n                {\n                    key: 'multicolorStart',\n                    label: 'Multicolor start',\n                    defaultValue: 263,\n                    type: \"range\",\n                    attr: {\n                        min: 0,\n                        max: 360,\n                        step: 1\n                    },\n                },\n                {\n                    key: 'multicolorByLightness',\n                    label: 'Multicolor by lightness',\n                    defaultValue: true,\n                    type: 'checkbox'\n                }\n            ]\n        }\n    ];\n\n    setUpDraw() {\n        super.setUpDraw();\n        const { n, rotation } = this.config;\n\n        this.circle = new Circle({\n            size: this.size,\n            n,\n            rotation,\n            margin: 20,\n        });\n        const {layers, multicolorRange, multicolorByLightness, layerSpread} = this.config;\n        this.multiColorStep = multicolorRange / layers;\n        this.multiColorLightnessStep = multicolorByLightness ? 100 / layers : 1;\n        this.layerShift = layerSpread;\n    }\n\n    *drawSpiral({ shift = 0, color = \"#f00\" } = {}) {\n        const {repetition, innerLength} = this.config;\n        \n        this.ctx.moveTo(...this.circle.getPoint(shift));\n        \n        let currentInnerLength = innerLength;\n        let repetitionCount = 0;\n        this.ctx.strokeStyle = color;\n        \n        for(let i=0; currentInnerLength; i++) {\n            this.ctx.beginPath();\n            this.ctx.lineTo(...this.circle.getPoint(i + currentInnerLength + shift));\n            this.ctx.lineTo(...this.circle.getPoint(i + 1 + shift));\n            this.ctx.stroke();\n\n            repetitionCount++;\n            if (repetitionCount === repetition) {\n                currentInnerLength--;\n                repetitionCount = 0;\n            }\n\n            yield i;\n        }\n      \n    }\n\n    *generateStrings() {\n        const { layers } = this.config;\n        for(let layer = 0; layer < layers; layer++) {\n            yield* this.drawSpiral({ \n                color: this.getLayerColor(layer), \n                shift: -this.layerShift * layer \n            });\n        }\n    }\n\n    getLayerColor(layer) {\n        const {multicolorStart, darkMode, multicolorByLightness} = this.config;\n        const lightness = multicolorByLightness ? this.multiColorLightnessStep * layer : darkMode ? 50 : 40;\n\n        return `hsl(${multicolorStart + layer * this.multiColorStep}, 80%, ${lightness}%)`;\n    }\n\n    getStepCount() {\n        const {innerLength, repetition, layers} = this.config;\n        return layers * innerLength * repetition;\n    }\n\n    drawNails() {\n        this.circle.drawNails(this.nails);\n    }\n}","import StringArt from \"../StringArt.js\";\nimport Circle from \"./Circle.js\";\n\nexport default class Circles extends StringArt {\n    name = \"Circles\";\n    id = \"circles\";\n    link = \"https://www.etsy.com/il-en/listing/1018950430/calming-wall-art-in-light-blue-for\";\n    controls = [\n        {\n            key: 'n',\n            label: 'Circle nails',\n            defaultValue: 80,\n            type: 'range',\n            attr: {\n                min: 1,\n                max: 300,\n                step: 1\n            }\n        },\n        {\n            key: 'minNailDistance',\n            label: 'Min nail distance',\n            defaultValue: 20,\n            type: 'range',\n            attr: {\n                min: 1,\n                max: 300,\n                step: 1\n            }\n        },\n        {\n            key: 'color',\n            label: 'Color',\n            defaultValue: \"#ec6ad0\",\n            type: \"color\",\n        },\n        {\n            key: 'layers',\n            label: 'Layers',\n            type: 'group',\n            children: [\n                {\n                    key: 'layer1',\n                    label: 'Layer 1',\n                    type: 'group',\n                    children: [\n                        {\n                            key: 'show1',\n                            label: 'Enable',\n                            defaultValue: true,\n                            type: 'checkbox'\n                        },\n                        {\n                            key: 'radius1',\n                            label: 'Radius',\n                            defaultValue: 0.5,\n                            type: 'range',\n                            attr: {\n                                min: 0.01,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show1}) => show1,\n                        },\n                        {\n                            key: 'x1',\n                            label: 'Position X',\n                            defaultValue: 0.5,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show1}) => show1,\n                        },\n                        {\n                            key: 'y1',\n                            label: 'Position Y',\n                            defaultValue: 0,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show1}) => show1,\n                        },\n                        {\n                            ...Circle.rotationConfig,\n                            key: 'rotation1',\n                            show: ({show1}) => show1,\n                        },\n                        {\n                            key: 'reverse1',\n                            label: 'Reverse',\n                            defaultValue: false,\n                            type: 'checkbox',\n                            show: ({show1}) => show1\n                        },\n                    ]\n                },\n                {\n                    key: 'layer2',\n                    label: 'Layer 2',\n                    type: 'group',\n                    children: [\n                        {\n                            key: 'show2',\n                            label: 'Enable',\n                            defaultValue: true,\n                            type: 'checkbox'\n                        },\n                        {\n                            key: 'radius2',\n                            label: 'Radius',\n                            defaultValue: 0.5,\n                            type: 'range',\n                            attr: {\n                                min: 0.01,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show2}) => show2,\n                        },\n                        {\n                            key: 'x2',\n                            label: 'Position X',\n                            defaultValue: 0,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show2}) => show2,\n                        },\n                        {\n                            key: 'y2',\n                            label: 'Position Y',\n                            defaultValue: 1,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show2}) => show2,\n                        },\n                        {\n                            ...Circle.rotationConfig,\n                            key: 'rotation2',\n                            show: ({show2}) => show2,\n                        },\n                        {\n                            key: 'reverse2',\n                            label: 'Reverse',\n                            defaultValue: false,\n                            type: 'checkbox',\n                            show: ({show2}) => show2\n                        },\n                    ]\n                },\n                {\n                    key: 'layer3',\n                    label: 'Layer 3',\n                    type: 'group',\n                    children: [\n                        {\n                            key: 'show3',\n                            label: 'Enable',\n                            defaultValue: true,\n                            type: 'checkbox'\n                        },\n                        {\n                            key: 'radius3',\n                            label: 'Radius',\n                            defaultValue: 0.5,\n                            type: 'range',\n                            attr: {\n                                min: 0.01,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show3}) => show3,\n                        },\n                        {\n                            key: 'x3',\n                            label: 'Position X',\n                            defaultValue: 1,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show3}) => show3,\n                        },\n                        {\n                            key: 'y3',\n                            label: 'Position Y',\n                            defaultValue: 1,\n                            type: 'range',\n                            attr: {\n                                min: 0,\n                                max: 1,\n                                step: 0.01\n                            },\n                            show: ({show3}) => show3,\n                        },\n                        {\n                            ...Circle.rotationConfig,\n                            key: 'rotation3',\n                            show: ({show3}) => show3,\n                        },\n                        {\n                            key: 'reverse3',\n                            label: 'Reverse',\n                            defaultValue: false,\n                            type: 'checkbox',\n                            show: ({show3}) => show3\n                        },\n                    ]\n                }\n            ]\n        }\n    ];\n\n    setUpDraw() {\n        super.setUpDraw();\n        Object.assign(this, this.getSetUp());\n    }\n\n    getSetUp() {\n        const { n, margin = 0, minNailDistance } = this.config;\n        const size = this.getSize();\n\n        const maxRadius = Math.min(...size.map(v => v - 2 * margin)) / 2;\n        const layers = new Array(3).fill(null)\n            .map((_, i) => getLayer.call(this, i + 1))\n            .filter(({enable}) => enable)\n\n        const maxShapeNailsCount = Math.max(...layers.map(({circle}) => circle.config.n));\n\n        return {\n            layers,\n            maxShapeNailsCount,\n        };\n\n        function getLayer(layerIndex) {\n            const prop = prop => this.config[prop + layerIndex];\n            \n            const props = {\n                enable: prop('show'),\n                isReverse: prop('reverse'),\n                position: [prop('x'), prop('y')],\n                radius: maxRadius * prop('radius'),\n                rotation: prop('rotation'),\n            };\n\n            const circumsference = Math.PI * 2 * props.radius;\n            const circleNails = Math.min(n, Math.floor(circumsference / minNailDistance));\n\n            const circle = new Circle({\n                radius: props.radius,\n                center: props.position.map((v, i) => props.radius + margin + (size[i] - (props.radius + margin) * 2) * v),\n                n: circleNails,\n                rotation: props.rotation,\n                reverse: props.isReverse,\n            });\n\n            return {\n                circle,\n                ...props\n            };\n        }\n    }\n\n    getPoint(layer, index) {\n        const {circle} = layer;\n        let circleIndex = Math.round(index * circle.config.n / this.maxShapeNailsCount);\n        return circle.getPoint(circleIndex);\n    }\n\n    *generateStrings() {\n        const {n, color} = this.config;\n\n        this.ctx.strokeStyle = color;\n        let prevCirclePoint;\n\n        for (let i = 0; i < this.maxShapeNailsCount; i++) {\n            for(let layerIndex = 0; layerIndex < this.layers.length; layerIndex++) {\n                const layer = this.layers[layerIndex];\n                this.ctx.beginPath();\n                this.ctx.moveTo(...(prevCirclePoint ?? this.getPoint(layer, i)));\n\n                if (layerIndex === 0 && i) {\n                    this.ctx.lineTo(...this.getPoint(layer, i));\n                }\n\n                let nextLayerIndex = layerIndex + 1;\n                if (nextLayerIndex === this.layers.length) {\n                    nextLayerIndex = 0;\n                }\n\n                prevCirclePoint = this.getPoint(this.layers[nextLayerIndex], i);\n                this.ctx.lineTo(...prevCirclePoint)\n                this.ctx.stroke();\n                yield;\n            }\n        }\n        \n    }\n\n    drawNails() {\n        const n = this.config;\n        this.layers.forEach(({circle}, layerIndex) => circle.drawNails(this.nails, { \n            getNumber: i => `${layerIndex + 1}_${i + 1}` \n        }));\n    }\n\n    getStepCount() {\n        const {layers, maxShapeNailsCount} = this.getSetUp();\n        return layers.length * maxShapeNailsCount - 1;\n    }\n}\n","const elements = {\n    controls: document.querySelector(\"#controls\"),\n    sidebarForm: document.querySelector(\"#sidebar_form\"),\n};\n\nconst EVENTS = new Set(['input', 'change']);\nconst STATE_LOCAL_STORAGE_KEY = 'controls_state';\n\nlet inputTimeout;\n\nexport default class EditorControls {\n    constructor({pattern}) {\n        this.pattern = pattern;\n        this.state = this._getState() ?? { groups: {}};\n\n        this.eventHandlers = {\n            input: new Set(),\n            change: new Set()\n        }\n\n        this._wrappedOnInput = e => this._onInput(e);\n        this._toggleFieldset = e => {\n            if (e.target.nodeName === \"LEGEND\" ) {\n                e.target.parentElement.classList.toggle(\"minimized\");\n                const groupId = e.target.parentElement.dataset.group;\n                this.state = { ...this.state, groups: { ...this.state.groups, [groupId]: !e.target.parentElement.classList.contains(\"minimized\")}};\n                this._updateState(this.state);\n            }\n        };\n\n        this._toggleFieldSetOnEnter = e => {\n            if (e.target.nodeName === \"LEGEND\" && e.key === \"Enter\") {\n                this._toggleFieldset(e);\n            }\n        }\n\n        elements.controls.addEventListener(\"input\", this._wrappedOnInput);\n        elements.sidebarForm.addEventListener(\"click\", this._toggleFieldset);\n        elements.sidebarForm.addEventListener(\"keydown\", this._toggleFieldSetOnEnter);\n        this.controlElements = {};\n        this.renderControls();\n    }\n\n    destroy() {\n        elements.controls.removeEventListener(\"input\", this._wrappedOnInput);\n        elements.sidebarForm.removeEventListener(\"click\", this._toggleFieldset);\n        elements.sidebarForm.removeEventListener(\"keydown\", this._toggleFieldSetOnEnter);\n        elements.controls.innerHTML = \"\";\n    }\n\n    addEventListener(event, eventHandler) {\n        if (!EVENTS.has(event)) {\n            throw new Error(`Unsupported event for EditorControls, \"${event}\"!`);\n        }\n\n        if (!(eventHandler instanceof Function)) {\n            throw new Error('Invalid event handler.');\n        }\n\n        this.eventHandlers[event].add(eventHandler);\n    }\n\n    _triggerEvent(event, eventData) {\n        for(const eventHandler of this.eventHandlers[event]) {\n            eventHandler(eventData);\n        }\n    }\n\n    _onInput(e) {\n        requestAnimationFrame(() => {\n            clearTimeout(inputTimeout);\n\n            const inputValue = getInputValue(e.target.type, e.target);\n            const controlKey = e.target.id.replace(/^config_/, '');\n\n            this.pattern.config = Object.freeze({\n                ...this.pattern.config,\n                [controlKey]: inputValue\n            });\n\n            const {config, displayValue} = this.controlElements[controlKey];\n            if (displayValue) {\n                const formattedValue = config.displayValue ? config.displayValue(this.pattern.config, config) : e.target.value;\n                displayValue.innerText = formattedValue;\n            }\n\n            const eventData = Object.freeze({\n                control: controlKey,\n                value: inputValue,\n                originalEvent: e,\n                pattern: this.pattern,\n            });\n\n            this._triggerEvent('input', eventData);\n\n            inputTimeout = setTimeout(() => {\n                this._triggerEvent('change', eventData);\n                this.updateControlsVisibility();\n            }, 100);\n        });\n    }\n\n    _getState() {\n        const state = localStorage.getItem(STATE_LOCAL_STORAGE_KEY);\n        if (state) {\n            try {\n                return JSON.parse(state);\n            } catch(e) {\n                return null;\n            }\n        }\n\n        return null;\n    }\n\n    _updateState(newState) {\n        if (newState) {\n            localStorage.setItem(STATE_LOCAL_STORAGE_KEY, JSON.stringify(newState));\n        } else {\n            localStorage.removeItem(STATE_LOCAL_STORAGE_KEY);\n        }\n    }\n\n    updateControlsVisibility(configControls = this.pattern.configControls) {\n        configControls.forEach(control => {\n            if (control.show) {\n                const shouldShowControl = control.show(this.pattern.config);\n                const controlEl = this.controlElements[control.key].control;\n                if (controlEl) {\n                    if (shouldShowControl) {\n                        controlEl.removeAttribute('hidden');\n                    } else {\n                        controlEl.setAttribute('hidden', 'hidden');\n                    }\n                }\n            }\n\n            if (control.isDisabled) {\n                const shouldDisableControl = control.isDisabled(this.pattern.config);\n                const inputEl = this.controlElements[control.key].input;\n                if (inputEl) {\n                    if (shouldDisableControl) {\n                        inputEl.setAttribute('disabled', 'disabled');\n                    } else {\n                        inputEl.removeAttribute('disabled');\n                    }\n                }\n            }\n\n            if (control.children) {\n                this.updateControlsVisibility(control.children);\n            }\n        });\n    }\n\n    updateInputs(config) {\n        Object.entries(config).forEach(([key, value]) => {\n            const {input, value: valueEl} = this.controlElements[key];\n            if (input) {\n                if (input.type === \"checkbox\") {\n                    input.checked = value;\n                } else {\n                    input.value = value;\n                }\n                if (valueEl) {\n                    valueEl.innerText = value;\n                }\n            }\n        });\n    }\n\n    renderControls(containerEl = elements.controls, _configControls) {\n        const configControls = _configControls ?? this.pattern.configControls;\n        containerEl.innerHTML = \"\";\n        const controlsFragment = document.createDocumentFragment();\n\n\n        configControls.forEach(control => {\n            const controlId = `config_${control.key}`;\n            const controlElements = this.controlElements[control.key] = { config: control };\n\n            let controlEl;\n\n            if (control.type === \"group\") {\n                controlEl = document.createElement(\"fieldset\");\n                controlEl.setAttribute('data-group', control.key);\n                const groupTitleEl = document.createElement(\"legend\");\n                groupTitleEl.setAttribute(\"tabindex\", \"0\");\n                groupTitleEl.innerText = control.label;\n                controlEl.appendChild(groupTitleEl);\n                controlEl.className = \"control control_group\";\n                const childrenContainer = document.createElement('div');\n                controlEl.appendChild(childrenContainer);\n                this.renderControls(childrenContainer, control.children);\n            }\n            else {\n                controlEl = document.createElement(\"div\");\n                controlEl.className = \"control\";\n\n                const label = document.createElement(\"label\");\n                label.innerHTML = control.label;\n                label.setAttribute(\"for\", controlId);\n\n                const inputEl = controlElements.input = document.createElement(\"input\");\n                inputEl.setAttribute(\"type\", control.type);\n                const inputValue = this.pattern.config[control.key] ?? control.defaultValue;\n\n                if (control.attr) {\n                    Object.entries(control.attr).forEach(([attr, value]) => {\n                        const realValue = value instanceof Function ? value(this.pattern) : value;\n                        inputEl.setAttribute(attr, realValue)\n                    });\n                }\n\n                if (control.type === \"checkbox\") {\n                    inputEl.checked = inputValue;\n                    controlEl.appendChild(inputEl);\n                    controlEl.appendChild(label);\n                } else {\n                    controlEl.appendChild(label);\n                    controlEl.appendChild(inputEl);\n                    inputEl.value = inputValue;\n                    const inputValueEl = controlElements.displayValue = document.createElement('span');\n                    inputValueEl.id = `config_${control.key}_value`;\n                    inputValueEl.innerText = control.displayValue ? control.displayValue(this.pattern.config, control) : inputValue;\n                    inputValueEl.className = \"control_input_value\";\n                    controlEl.appendChild(inputValueEl);\n                }\n                inputEl.id = controlId;\n            }\n\n            this.controlElements[control.key].control = controlEl;\n            controlEl.id = `control_${control.key}`;\n            controlsFragment.appendChild(controlEl);\n        });\n\n        containerEl.appendChild(controlsFragment);\n        this.updateGroupsState();\n        requestAnimationFrame(() => this.updateControlsVisibility())\n    }\n\n    updateGroupsState() {\n        const groups = elements.sidebarForm.querySelectorAll('[data-group]');\n        groups.forEach(groupEl => {\n            const groupId = groupEl.dataset.group;\n            const groupState = this.state.groups[groupId];\n            if (typeof groupState === 'boolean') {\n                if (groupState) {\n                    groupEl.classList.remove('minimized');\n                } else {\n                    groupEl.classList.add('minimized');\n                }\n            }\n        });\n    }\n}\n\n\nfunction getInputValue(type, inputElement) {\n    switch(type) {\n        case 'range':\n            return parseFloat(inputElement.value);\n        case 'checkbox':\n            return inputElement.checked;\n        case 'number':\n            return parseFloat(inputElement.value);\n        default:\n            return inputElement.value;\n    }\n}\n","const sizeControls = document.querySelector(\"#size_controls\");\n\nconst elements = {\n    sizeSelect: sizeControls.querySelector(\"#size_select\"),\n    sizeCustom: sizeControls.querySelector(\"#size_custom\"),\n    width: sizeControls.querySelector(\"#size_custom_width\"),\n    height: sizeControls.querySelector(\"#size_custom_height\"),\n    orientationSelect: sizeControls.querySelector(\"#size_orientation_select\"),\n};\n\nfunction cmToPixels(cm, dpi = 300) {\n    return Math.floor(cm / 2.54 * dpi);\n}\n\nconst SCREEN_SIZE = [\n    Math.floor(window.screen.width),\n    Math.floor(window.screen.height),\n];\n\nconst SIZES = [\n    { id: 'fit', name: 'Fit to screen' },\n    { id: 'A4', value: [20, 28].map(v => cmToPixels(v)), orientationSelect: true },\n    { id: 'A3', value: [28, 40].map(v => cmToPixels(v)), orientationSelect: true },\n    { id: 'screen', name: `Screen size (${SCREEN_SIZE.join('x')})`, value: SCREEN_SIZE},\n    { id: 'custom', name: 'Custom...' }\n];\n\nexport default class EditorSizeControls {\n    element = document.querySelector(\"#size_controls\");\n\n    constructor({ getCurrentSize }) {\n        const sizeOptionsFragment = document.createDocumentFragment();\n        SIZES.forEach(size => {\n            const sizeListItem = document.createElement('option');\n            sizeListItem.setAttribute('value', size.id);\n            sizeListItem.innerText = size.name ?? size.id;\n            sizeOptionsFragment.appendChild(sizeListItem);\n        });\n        elements.sizeSelect.appendChild(sizeOptionsFragment)\n        this.selectedSize = SIZES[0];\n\n        elements.sizeSelect.addEventListener(\"change\", e => {\n            const selectedSizeId = e.target.value;\n            const size = SIZES.find(({id}) => id === selectedSizeId);\n            this.selectedSize = size;\n\n            if (size.id === \"custom\") {\n                elements.sizeCustom.removeAttribute('hidden');\n                const [width, height] = getCurrentSize();\n                elements.width.value = width;\n                elements.height.value = height;\n            } else {\n                elements.sizeCustom.setAttribute('hidden', 'hidden');\n                this._notifyOnChange(this.getValue());\n            }\n\n            if (size.orientationSelect) {\n                elements.orientationSelect.removeAttribute('hidden');\n            } else {\n                elements.orientationSelect.setAttribute('hidden', 'hidden');\n            }\n        });\n\n        elements.orientationSelect.addEventListener(\"change\", e => {\n            this._notifyOnChange(this.getValue());\n        });\n\n        elements.sizeCustom.addEventListener(\"focusin\", e => {\n            e.target.select();\n        });\n\n        elements.sizeCustom.addEventListener('input', () => {\n            this._notifyOnChange([\n                elements.width.value ? parseInt(elements.width.value) : null,\n                elements.height.value ? parseInt(elements.height.value) : null\n            ]);\n        });\n    }\n\n    _notifyOnChange([width, height] = []) {\n        this.element.dispatchEvent(new CustomEvent('sizechange', { detail: { width, height }}));\n    }\n\n    getValue() {\n        if (this.selectedSize.id === \"custom\") {\n            return [parseInt(elements.width.value, 10), parseInt(elements.height.value, 10)];\n        } else {\n            let value = this.selectedSize.value;\n            if (this.selectedSize.orientationSelect && elements.orientationSelect.value === \"horizontal\") {\n                value = Array.from(value).reverse();\n            }\n            return value;\n        }\n\n    }\n}\n","import Player from \"./editor/Player.js\";\nimport patternTypes from \"./pattern_types.js\";\nimport EditorControls from \"./editor/EditorControls.js\";\nimport EditorSizeControls from \"./editor/EditorSizeControls.js\";\n\nconst elements = {\n    canvas: document.querySelector(\"canvas\"),\n    patternSelector: document.querySelector(\"#pattern_select\"),\n    patternLink: document.querySelector(\"#pattern_link\"),\n    downloadBtn: document.querySelector(\"#download_btn\"),\n    downloadNailsBtn: document.querySelector(\"#download_nails_btn\"),\n};\n\nconst patterns = patternTypes.map(Pattern => new Pattern(elements.canvas));\n\nlet currentPattern;\nconst player = new Player(document.querySelector(\"#player\"));\nconst sizeControls = new EditorSizeControls({\n    getCurrentSize: () => [\n        elements.canvas.clientWidth,\n        elements.canvas.clientHeight\n    ]\n});\n\nlet controls;\n\nmain();\n\nfunction main() {\n    initRouting();\n    initSize();\n    initControls();\n\n    if (history.state?.pattern) {\n        updateState(history.state);\n    } else {\n        const queryParams = new URLSearchParams(document.location.search);\n        const queryPattern = queryParams.get('pattern');\n\n        if (queryPattern) {\n            const config = queryParams.get('config');\n            updateState({ pattern: queryPattern, config })\n        } else {\n            selectPattern(patterns[0]);\n        }\n    }\n\n    window.addEventListener(\"resize\", () =>\n        currentPattern.draw()\n    );\n\n    elements.canvas.addEventListener('click', () => {\n        player.toggle();\n    });\n\n    elements.downloadBtn.addEventListener('click', downloadCanvas);\n    elements.downloadNailsBtn.addEventListener('click', downloadNailsImage);\n}\n\nfunction downloadCanvas() {\n    const downloadLink = document.createElement('a');\n    downloadLink.download = currentPattern.name + '.png';\n    downloadLink.href = elements.canvas.toDataURL(\"image/png\");\n    downloadLink.setAttribute('target', 'download')\n    downloadLink.click();\n}\n\nfunction downloadNailsImage() {\n    const currentConfig = currentPattern.config;\n    currentPattern.config = {\n        darkMode: false,\n        showNails: true,\n        showNailNumbers: true,\n        showStrings: false,\n        nailsColor: \"#000000\",\n    };\n    currentPattern.draw();\n    downloadCanvas();\n}\n\nfunction onInputsChange() {\n    player.update(currentPattern);\n    const configQuery = JSON.stringify(currentPattern.config);\n    history.replaceState({\n        pattern: currentPattern.id,\n        config: configQuery\n    }, currentPattern.name, `?pattern=${currentPattern.id}&config=${encodeURIComponent(configQuery)}`);\n}\n\nfunction initControls() {\n    patterns.forEach(pattern => {\n        const option = document.createElement('option');\n        option.innerText = pattern.name;\n        option.value = pattern.id;\n        elements.patternSelector.appendChild(option);\n    });\n\n    elements.patternSelector.addEventListener('change', e => {\n        const patternId = e.target.value;\n        selectPattern(findPatternById(patternId));\n        history.pushState({ pattern: patternId }, patternId, \"?pattern=\" + patternId)\n    });\n}\n\nfunction initSize() {\n    sizeControls.element.addEventListener('sizechange', ({ detail }) => {\n        setSize(detail);\n    });\n}\n\nfunction setSize({width, height}) {\n    elements.canvas.removeAttribute('width');\n    elements.canvas.removeAttribute('height');\n\n    if (width && height) {\n        elements.canvas.style.width = `${width}px`;\n        elements.canvas.style.height = `${height}px`;\n    } else {\n        elements.canvas.removeAttribute('style');\n    }\n\n    currentPattern.draw();\n}\n\nfunction initRouting() {\n    window.addEventListener('popstate', ({state}) => {\n        updateState(state);\n    });\n}\n\nfunction updateState(state) {\n    const pattern = findPatternById(state.pattern);\n    elements.patternSelector.value = pattern.id;\n    selectPattern(pattern, {\n        draw: false,\n        config: state.config ? JSON.parse(state.config) : null\n    });\n\n    currentPattern.draw();\n}\n\nfunction findPatternById(patternId) {\n    const pattern = patterns.find(({id}) => id === patternId);\n    if (!pattern) {\n        throw new Error(`Pattern with id \"${patternId} not found!`);\n    }\n    return pattern;\n}\n\nfunction selectPattern(pattern, { config, draw = true} = {}) {\n    currentPattern = pattern;\n    if (config) {\n        currentPattern.config = config;\n    }\n    if (controls) {\n        controls.destroy();\n    }\n    controls = new EditorControls({pattern, config});\n    controls.addEventListener('input', () => currentPattern.draw());\n    controls.addEventListener('change', onInputsChange);\n\n    elements.patternLink.setAttribute(\"href\", pattern.link);\n    if (draw) {\n        currentPattern.draw();\n    }\n    player.update(currentPattern, { draw: false });\n    document.title = `${pattern.name} - String Art Studio`;\n}\n","export default class Player {\n    constructor(parentEl) {\n        this.elements = {\n            player: parentEl,\n            step: parentEl.querySelector('#step'),\n            stepInstructions: parentEl.querySelector('#step_instructions'),\n            playerPosition: parentEl.querySelector('#player_position'),\n            playBtn: parentEl.querySelector('#play_btn'),\n            pauseBtn: parentEl.querySelector('#pause_btn')\n        };\n        this.stepCount = 0;\n        this._isPlaying = false;\n\n        this.elements.playerPosition.addEventListener('input', ({ target }) => {\n            this.goto(+target.value)\n        });\n\n        this.elements.playBtn.addEventListener('click', () => {\n            this.play();\n        });\n\n        this.elements.pauseBtn.addEventListener('click', () => {\n            this.pause();\n        });\n    }\n\n    updateStatus(isPlaying) {\n        if (this._isPlaying !== isPlaying) {\n            this.elements.player.classList.toggle('playing');\n            this._isPlaying = isPlaying;\n        }\n    }\n\n    update(stringArt, { draw = true} = {}) {\n        this.stringArt = stringArt;\n        this.stepCount = stringArt.getStepCount();\n        this.elements.playerPosition.setAttribute('max', this.stepCount);\n        this.goto(this.stepCount, { updateStringArt: draw });\n    }\n\n    updatePosition(position) {\n        this.elements.step.innerText = `${position}/${this.stepCount}`;\n        this.elements.playerPosition.value = position;\n    }\n\n    goto(position, { updateStringArt = true} = {}) {\n        this.pause();\n        this.updatePosition(position);\n        if (updateStringArt) {\n            this.stringArt.goto(position);\n        }\n    }\n\n    setInstructions(instructions) {\n        this.elements.stepInstructions.innerText = instructions;\n    }\n\n    play() {\n        this.updateStatus(true);\n        cancelAnimationFrame(this.renderRafId);\n\n        if (this.stringArt.position === this.stepCount) {\n            this.stringArt.goto(0);\n        }\n\n        const self = this;\n\n        step();\n\n        function step() {\n            if (!self.stringArt.drawNext().done) {\n                self.renderRafId = requestAnimationFrame(step);\n            } else {\n                self.updateStatus(false);\n            }\n            self.updatePosition(self.stringArt.position);\n        }\n    }\n\n    pause() {\n        cancelAnimationFrame(this.renderRafId);\n        this.updateStatus(false);\n    }\n\n    toggle() {\n        if (this._isPlaying) {\n            this.pause();\n        } else {\n            this.play();\n        }\n    }\n}\n"],"names":["$a8180031c78213da$var$PI2","Math","PI","canvas","config","this","context","getContext","setConfig","centerX","width","nails","nailRadius","nailsColor","nailNumbersFontSize","addNail","nail","push","fill","drawNumbers","globalCompositeOperation","beginPath","fillStyle","textBaseline","font","nailNumberOffset","forEach","point","x","y","number","moveTo","arc","isRightAlign","numberPosition","textAlign","fillText","String","$65e05ee91a8797e3$var$COLORS","$65e05ee91a8797e3$var$COMMON_CONFIG_CONTROLS","key","label","type","defaultValue","children","isDisabled","showNails","attr","min","max","step","show","showStrings","displayValue","margin","showNailNumbers","customBackgroundColor","$65e05ee91a8797e3$var$flattenConfig","configControls","reduce","$65e05ee91a8797e3$export$2e2bcd8739ae039","Error","ctx","dpr","window","devicePixelRatio","bsr","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","pixelRatio","controls","concat","defaultConfig","_defaultConfig","_config","value","Object","assign","getSize","clientWidth","clientHeight","map","v","setUpDraw","removeAttribute","height","size","setAttribute","center","$a8180031c78213da$export$2e2bcd8739ae039","clearRect","lineWidth","stringWidth","afterDraw","drawNails","initDraw","darkMode","backgroundColor","fillRect","draw","position","Infinity","stringsIterator","generateStrings","drawNext","done","goto","result","next","getStepCount","name","$17fe1039ca333e84$export$2e2bcd8739ae039","id","link","n","radiusIncrease","angleStep","nSpirals","currentRadius","angle","centerx","centery","i","s","rotation","sin","cos","nailNumber","points","generatePoints","index","strokeStyle","color","lastPoint","lineTo","stroke","$188437ce07b37c18$var$PI2","radius","reverse","indexAngle","rotationAngle","isReverse","getPoint","realIndex","nailsNumberStart","getNumber","round","$f11ad0f2a18da5c9$var$SIDES","$f11ad0f2a18da5c9$var$SIDES_ORDER","$f11ad0f2a18da5c9$var$SIDES_ROTATION","left","bottom","right","top","$f11ad0f2a18da5c9$export$2e2bcd8739ae039","super","maxSize","nailSpacing","layerAngle","layerStart","theta","pivot","cosAngle","sinAngle","side","layerStringCount","sideIndex","indexOf","nextSide","length","nextSideRotation","sideProps","_getLayerProps","layerIndex","colors","_getLayerColors","layerSize","pow","floor","color1","color2","colorPerLayer","layerColor","drawSide","layers","layer","drawLayer","count","sideOrder","$8b13425f1e264518$export$2e2bcd8739ae039","$188437ce07b37c18$export$2e2bcd8739ae039","rotationConfig","_n","sides","extraNails","sideNails","circle","sideAngle","starCenterStart","Array","_","circlePointsStart","sinSideAngle","cosSideAngle","circlePointsEnd","getStarPoint","centerY","reverseOrder","prevSide","innerColor","prevPoint","generateStarPoints","prevSideIndex","outterColor","prevCirclePoint","isPrevSide","nextPointIndex","nextPoint","drawCircle","drawStar","size1","show1","end1","size2","show2","end2","size3","show3","getSetUp","lineSpacing","lineNailCount","firstCirclePoint","totalNailCount","totalIndexCount","getLayer","call","filter","enable","endIndex","indexLength","circleIndex","prevPointIndex","self","advance","getPointIndex","stepCount","multicolor","multicolorRange","multiColorStep","layerShift","shift","steps","time","base","stepsToRender","toIndex","instructions","timeColor","getTimeColor","drawTimesTable","multicolorStart","multicolorByLightness","layerSpread","multiColorLightnessStep","repetition","innerLength","currentInnerLength","repetitionCount","drawSpiral","getLayerColor","lightness","minNailDistance","maxRadius","maxShapeNailsCount","prop","props","circumsference","circleNails","nextLayerIndex","$2fc16ffa17719734$var$elements","document","querySelector","sidebarForm","$2fc16ffa17719734$var$EVENTS","Set","$2fc16ffa17719734$var$inputTimeout","pattern","state","_getState","groups","eventHandlers","input","change","_wrappedOnInput","e","_onInput","_toggleFieldset","target","nodeName","parentElement","classList","toggle","groupId","dataset","group","contains","_updateState","_toggleFieldSetOnEnter","addEventListener","controlElements","renderControls","destroy","removeEventListener","innerHTML","event","eventHandler","has","Function","add","_triggerEvent","eventData","requestAnimationFrame","clearTimeout","inputValue","inputElement","parseFloat","checked","$2fc16ffa17719734$var$getInputValue","controlKey","replace","freeze","formattedValue","innerText","control","originalEvent","setTimeout","updateControlsVisibility","localStorage","getItem","JSON","parse","newState","setItem","stringify","removeItem","shouldShowControl","controlEl","shouldDisableControl","inputEl","updateInputs","entries","valueEl","containerEl","_configControls","controlsFragment","createDocumentFragment","controlId","createElement","groupTitleEl","appendChild","className","childrenContainer","realValue","inputValueEl","updateGroupsState","querySelectorAll","groupEl","groupState","remove","$0597ff46967fdd49$var$sizeControls","$0597ff46967fdd49$var$elements","sizeSelect","sizeCustom","orientationSelect","$0597ff46967fdd49$var$cmToPixels","cm","dpi","$0597ff46967fdd49$var$SCREEN_SIZE","screen","$0597ff46967fdd49$var$SIZES","join","$52852adbc3c0b381$var$elements","patternSelector","patternLink","downloadBtn","downloadNailsBtn","$52852adbc3c0b381$var$patterns","Pattern","$52852adbc3c0b381$var$currentPattern","$52852adbc3c0b381$var$player","parentEl","elements","player","stepInstructions","playerPosition","playBtn","pauseBtn","_isPlaying","play","pause","updateStatus","isPlaying","update","stringArt","updateStringArt","updatePosition","setInstructions","cancelAnimationFrame","renderRafId","$52852adbc3c0b381$var$sizeControls","element","getCurrentSize","sizeOptionsFragment","sizeListItem","selectedSize","selectedSizeId","find","_notifyOnChange","getValue","select","parseInt","dispatchEvent","CustomEvent","detail","from","$52852adbc3c0b381$var$controls","$52852adbc3c0b381$var$downloadCanvas","downloadLink","download","href","toDataURL","click","$52852adbc3c0b381$var$downloadNailsImage","$52852adbc3c0b381$var$onInputsChange","configQuery","history","replaceState","encodeURIComponent","$52852adbc3c0b381$var$updateState","$52852adbc3c0b381$var$findPatternById","$52852adbc3c0b381$var$selectPattern","patternId","$2fc16ffa17719734$export$2e2bcd8739ae039","title","$52852adbc3c0b381$var$initRouting","style","$52852adbc3c0b381$var$setSize","$52852adbc3c0b381$var$initSize","option","pushState","$52852adbc3c0b381$var$initControls","queryParams","URLSearchParams","location","search","queryPattern","get","$52852adbc3c0b381$var$main"],"version":3,"file":"index.dda348aa.js.map"}